<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>第 1 页 | K1 biogithub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta property="og:type" content="website">
<meta property="og:title" content="K1 biogithub">
<meta property="og:url" content="https://hyinli.github.io/index.html">
<meta property="og:site_name" content="K1 biogithub">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="K1 biogithub">
  
    <link rel="alternate" href="/atom.xml" title="K1 biogithub" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css">
  <link rel="stylesheet" href="/css/fashion.css">
  <link rel="stylesheet" href="/css/glyphs.css">

</head>
</html>


  <body>


  


<header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="K1 biogithub" rel="home"> K1 biogithub </a>
            
          </h1>
          
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows" style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/">首页</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/categories">分类</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/tags">标签</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/archives">归档</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/links">links</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/about">关于</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main">
  
    <article id="post-oo" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2019/05/01/oo/">生信技能树R作业答案-高级</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2019/05/01/oo/" class="article-date">
	  <time datetime="2019-05-01T06:34:13.335Z" itemprop="datePublished">五月 1, 2019</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/R/">R</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>true</p>
<h1 id="1-安装一些r包"><a class="markdownIt-Anchor" href="#1-安装一些r包"></a> 1 安装一些R包</h1>
<p>数据包： ALL, CLL, pasilla, airway<br>
软件包：limma，DESeq2，clusterProfiler 工具包：reshape2 绘图包：ggplot2</p>
<pre><code>rm(list = ls())
if(F){
  source(&quot;http://bioconductor.org/biocLite.R&quot;)
  options(&quot;repos&quot; = c(CRAN=&quot;https://mirrors.tuna.tsinghua.edu.cn/CRAN/&quot;))
  options(BioC_mirror=&quot;http://mirrors.ustc.edu.cn/bioc/&quot;)#修改镜像，安装会加速
  BiocManager::install(&quot;clusterProfiler&quot;)
  BiocManager::install(&quot;ComplexHeatmap&quot;)
  BiocManager::install(&quot;maftools&quot;)
  BiocManager::install(&quot;reshape2&quot;)
}
</code></pre>
<h1 id="2了解expressionset对象比如cll包里面就有datascllex-找到它包含的元素提取其表达矩阵使用exprs函数查看其大小"><a class="markdownIt-Anchor" href="#2了解expressionset对象比如cll包里面就有datascllex-找到它包含的元素提取其表达矩阵使用exprs函数查看其大小"></a> 2.了解ExpressionSet对象，比如CLL包里面就有data(sCLLex) 找到它包含的元素，提取其表达矩阵(使用exprs函数)，查看其大小</h1>
<p>A.参考：<a href="http://www.bio-info-trainee.com/bioconductor_China/software/limma.html" target="_blank" rel="noopener">http://www.bio-info-trainee.com/bioconductor_China/software/limma.html</a><br>
B.参考：<a href="https://github.com/bioconductor-china/basic/blob/master/ExpressionSet.md" target="_blank" rel="noopener">https://github.com/bioconductor-china/basic/blob/master/ExpressionSet.md</a></p>
<pre><code>library(CLL)
data(&quot;sCLLex&quot;)
View(sCLLex)#查看其包含的元素
sCLLex#查看包含的元素

## ExpressionSet (storageMode: lockedEnvironment)
## assayData: 12625 features, 22 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: CLL11.CEL CLL12.CEL ... CLL9.CEL (22 total)
##   varLabels: SampleID Disease
##   varMetadata: labelDescription
## featureData: none
## experimentData: use 'experimentData(object)'
## Annotation: hgu95av2

exp &lt;- exprs(sCLLex)#提取表达矩阵
dim(exp)#查看其大小

## [1] 12625    22

group &lt;- pData(sCLLex)#提取分组信息
table(group)#设计矩阵

##         Disease
## SampleID progres. stable
##    CLL11        1      0
##    CLL12        0      1
##    CLL13        1      0
##    CLL14        1      0
##    CLL15        1      0
##    CLL16        1      0
##    CLL17        0      1
##    CLL18        0      1
##    CLL19        1      0
##    CLL2         0      1
##    CLL20        0      1
##    CLL21        1      0
##    CLL22        0      1
##    CLL23        1      0
##    CLL24        0      1
##    CLL3         1      0
##    CLL4         1      0
##    CLL5         1      0
##    CLL6         1      0
##    CLL7         1      0
##    CLL8         1      0
##    CLL9         0      1
</code></pre>
<h1 id="3了解-strheadhelp函数"><a class="markdownIt-Anchor" href="#3了解-strheadhelp函数"></a> 3了解 str,head,help函数</h1>
<p>作用于 第二步提取到的表达矩阵</p>
<pre><code>str(exp)

##  num [1:12625, 1:22] 5.74 2.29 3.31 1.09 7.54 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:12625] &quot;1000_at&quot; &quot;1001_at&quot; &quot;1002_f_at&quot; &quot;1003_s_at&quot; ...
##   ..$ : chr [1:22] &quot;CLL11.CEL&quot; &quot;CLL12.CEL&quot; &quot;CLL13.CEL&quot; &quot;CLL14.CEL&quot; ...

head(exp)

##           CLL11.CEL CLL12.CEL CLL13.CEL CLL14.CEL CLL15.CEL CLL16.CEL
## 1000_at    5.743132  6.219412  5.523328  5.340477  5.229904  4.920686
## 1001_at    2.285143  2.291229  2.287986  2.295313  2.662170  2.278040
## 1002_f_at  3.309294  3.318466  3.354423  3.327130  3.365113  3.568353
## 1003_s_at  1.085264  1.117288  1.084010  1.103217  1.074243  1.073097
## 1004_at    7.544884  7.671801  7.474025  7.152482  6.902932  7.368660
## 1005_at    5.083793  7.610593  7.631311  6.518594  5.059087  4.855161
##           CLL17.CEL CLL18.CEL CLL19.CEL CLL20.CEL CLL21.CEL CLL22.CEL
## 1000_at    5.325348  4.826131  5.212387  5.285830  5.581859  6.251678
## 1001_at    2.350796  2.325163  2.432635  2.256547  2.348389  2.263849
## 1002_f_at  3.502440  3.394410  3.617099  3.279726  3.391734  3.306811
## 1003_s_at  1.091264  1.076470  1.132558  1.096870  1.138386  1.061184
## 1004_at    6.456285  6.824862  7.304803  8.757756  6.695295  7.372185
## 1005_at    5.176975  4.874563  4.097580  9.250585  7.657463  7.683677
##           CLL23.CEL CLL24.CEL CLL2.CEL CLL3.CEL CLL4.CEL CLL5.CEL CLL6.CEL
## 1000_at    5.480752  5.216033 5.966942 5.397508 5.281720 5.414718 5.460626
## 1001_at    2.264434  2.344079 2.350073 2.406846 2.341961 2.372928 2.356978
## 1002_f_at  3.341444  3.798335 3.427736 3.453564 3.412944 3.411922 3.396466
## 1003_s_at  1.046188  1.082169 1.501367 1.191339 1.139510 1.153548 1.135671
## 1004_at    7.616749  6.839187 7.545673 8.802729 7.307752 7.491507 8.063202
## 1005_at    8.700667  5.546996 9.611601 5.732182 6.483191 6.072558 9.919125
##           CLL7.CEL CLL8.CEL CLL9.CEL
## 1000_at   5.897821 5.253883 5.214155
## 1001_at   2.222276 2.254772 2.358544
## 1002_f_at 3.247276 3.255148 3.365746
## 1003_s_at 1.074631 1.166247 1.151184
## 1004_at   7.014543 8.019108 7.432331
## 1005_at   5.149411 4.989604 5.339848

help(exp)

## starting httpd help server ... done
</code></pre>
<h1 id="4安装并了解-hgu95av2db-包"><a class="markdownIt-Anchor" href="#4安装并了解-hgu95av2db-包"></a> 4安装并了解 hgu95av2.db 包</h1>
<p>看看 ls(“package:hgu95av2.db”) 后 显示的那些变量</p>
<pre><code>library(hgu95av2.db)
ls(&quot;package:hgu95av2.db&quot;)

##  [1] &quot;hgu95av2&quot;              &quot;hgu95av2.db&quot;          
##  [3] &quot;hgu95av2_dbconn&quot;       &quot;hgu95av2_dbfile&quot;      
##  [5] &quot;hgu95av2_dbInfo&quot;       &quot;hgu95av2_dbschema&quot;    
##  [7] &quot;hgu95av2ACCNUM&quot;        &quot;hgu95av2ALIAS2PROBE&quot;  
##  [9] &quot;hgu95av2CHR&quot;           &quot;hgu95av2CHRLENGTHS&quot;   
## [11] &quot;hgu95av2CHRLOC&quot;        &quot;hgu95av2CHRLOCEND&quot;    
## [13] &quot;hgu95av2ENSEMBL&quot;       &quot;hgu95av2ENSEMBL2PROBE&quot;
## [15] &quot;hgu95av2ENTREZID&quot;      &quot;hgu95av2ENZYME&quot;       
## [17] &quot;hgu95av2ENZYME2PROBE&quot;  &quot;hgu95av2GENENAME&quot;     
## [19] &quot;hgu95av2GO&quot;            &quot;hgu95av2GO2ALLPROBES&quot; 
## [21] &quot;hgu95av2GO2PROBE&quot;      &quot;hgu95av2MAP&quot;          
## [23] &quot;hgu95av2MAPCOUNTS&quot;     &quot;hgu95av2OMIM&quot;         
## [25] &quot;hgu95av2ORGANISM&quot;      &quot;hgu95av2ORGPKG&quot;       
## [27] &quot;hgu95av2PATH&quot;          &quot;hgu95av2PATH2PROBE&quot;   
## [29] &quot;hgu95av2PFAM&quot;          &quot;hgu95av2PMID&quot;         
## [31] &quot;hgu95av2PMID2PROBE&quot;    &quot;hgu95av2PROSITE&quot;      
## [33] &quot;hgu95av2REFSEQ&quot;        &quot;hgu95av2SYMBOL&quot;       
## [35] &quot;hgu95av2UNIGENE&quot;       &quot;hgu95av2UNIPROT&quot;

ls(hgu95av2.db)

## [1] &quot;conn&quot;        &quot;packageName&quot;

head(toTable(hgu95av2SYMBOL))

##    probe_id  symbol
## 1   1000_at   MAPK3
## 2   1001_at    TIE1
## 3 1002_f_at CYP2C19
## 4 1003_s_at   CXCR5
## 5   1004_at   CXCR5
## 6   1005_at   DUSP1

ids &lt;- toTable(hgu95av2SYMBOL)
</code></pre>
<h2 id="以下几种方法获取tp53的探针名称"><a class="markdownIt-Anchor" href="#以下几种方法获取tp53的探针名称"></a> 以下几种方法获取TP53的探针名称</h2>
<h3 id="1-subset函数"><a class="markdownIt-Anchor" href="#1-subset函数"></a> 1 subset函数</h3>
<pre><code>a1 &lt;- subset(ids, ids$symbol=='TP53')
</code></pre>
<h3 id="2-grep函数"><a class="markdownIt-Anchor" href="#2-grep函数"></a> 2 grep函数</h3>
<pre><code>a4 &lt;- ids[grep(&quot;^TP53$&quot;, ids$symbol),]
</code></pre>
<h3 id="3-filter函数依赖dplyr包"><a class="markdownIt-Anchor" href="#3-filter函数依赖dplyr包"></a> 3 filter函数(依赖dplyr包)</h3>
<pre><code>a5 &lt;- filter(ids, ids$symbol=='TP53')
</code></pre>
<p>理解探针与基因的对应关系，总共多少个基因，基因最多对应多少个探针，<br>
是哪些基因，是不是因为这些基因很长，所以在其上面设计多个探针呢？总共多少gene</p>
<pre><code>length(unique(ids$symbol))

## [1] 8585
</code></pre>
<p>对应探针多的是那些gene</p>
<pre><code>ids_fre &lt;- data.frame(table(ids$symbol))
tail(ids_fre[order(ids_fre$Freq),])

##        Var1 Freq
## 8365 YME1L1    7
## 2809  GAPDH    8
## 3638 INPP4A    8
## 4720    MYB    8
## 6010 PTGER3    8
## 7339  STAT1    8
</code></pre>
<p>或者用sort命令</p>
<pre><code>tail(sort(table(ids$symbol)))

## 
## YME1L1  GAPDH INPP4A    MYB PTGER3  STAT1 
##      7      8      8      8      8      8
</code></pre>
<p>不管是Agilent芯片，还是Affymetrix芯片，上面设计的探针都非常短。<br>
最长的如Agilent芯片上的探针，往往都是60bp，但是往往一个基因的长<br>
度都好几Kb。因此一般多个探针对应一个基因，取最大表达值探针来作为<br>
基因的表达量。 # 7.找到芯片有而hgu95av2.db中没有对应基因名的探针<br>
第二步提取到的表达矩阵是12625个探针在22个样本的表达量矩阵， 找到那些不在<br>
hgu95av2.db 包收录的对应着SYMBOL的探针。<br>
提示：有1165个探针是没有对应基因名字的。 ## 第一种方法：match函数</p>
<pre><code>dim(exp)

## [1] 12625    22

dim(hgu95av2SYMBOL)

## [1] 11460     2

b1 &lt;- exp[-match(ids$probe_id, rownames(exp)),]
dim(b1)

## [1] 1165   22
</code></pre>
<h2 id="第二种方法in函数"><a class="markdownIt-Anchor" href="#第二种方法in函数"></a> 第二种方法:%in%函数</h2>
<pre><code>b2 &lt;- exp[!(rownames(exp) %in% ids$probe_id),]
b1==b2
</code></pre>
<h1 id="8-过滤表达矩阵删除注释包中没有对应基因名的探针"><a class="markdownIt-Anchor" href="#8-过滤表达矩阵删除注释包中没有对应基因名的探针"></a> 8 过滤表达矩阵：删除注释包中没有对应基因名的探针</h1>
<p>过滤表达矩阵，删除那1165个没有对应基因名字的探针。</p>
<pre><code>exp_filter_no_symbol &lt;- as.data.frame(exp[match(ids$probe_id, rownames(exp)),])
exp_filter_no_symbol2 &lt;- as.data.frame(exp[rownames(exp) %in% ids$probe_id,])
</code></pre>
<h1 id="9-整合表达矩阵多个探针对应一个基因的情况下只保留在所有样本里面平均表达量最大的那个探针"><a class="markdownIt-Anchor" href="#9-整合表达矩阵多个探针对应一个基因的情况下只保留在所有样本里面平均表达量最大的那个探针"></a> 9 整合表达矩阵，多个探针对应一个基因的情况下，只保留在所有样本里面平均表达量最大的那个探针。</h1>
<p>提示，理解 tapply,by,aggregate,split 函数 ,<br>
首先对每个基因找到最大表达量的探针。 然后根据得到探针去过滤原始表达矩阵<br>
这种方法能够一定程度上增加差异基因的数目，但也容易造成假阳性的结果<br>
<a href="https://blog.csdn.net/tommyhechina/article/details/80468361" target="_blank" rel="noopener">https://blog.csdn.net/tommyhechina/article/details/80468361</a><br>
合并探针，先看有无NA值，若有，可以删除或填充<br>
先检查有无，若返回值&gt;0,说明有NA值。</p>
<pre><code>length(which(is.na(exp_filter_no_symbol)))

## [1] 0
</code></pre>
<p>结果是0，说明没有NA值。如果有则用impute包来进行填充 exp_symbol&lt;-<br>
impute.knn(exp_symbol)$data 下面开始进行合并，用aggregate命令</p>
<pre><code>ids &lt;- toTable(hgu95av2SYMBOL)
ids$median &lt;- apply(exp_filter_no_symbol, 1, median)
ids &lt;- ids[order(ids$symbol, ids$median, decreasing = T),]
ids_filtered &lt;- ids[!duplicated(ids$symbol),]
dim(ids_filtered)

## [1] 8585    3
</code></pre>
<h1 id="10-过滤后的表达矩阵行名改为symbol"><a class="markdownIt-Anchor" href="#10-过滤后的表达矩阵行名改为symbol"></a> 10 过滤后的表达矩阵行名改为SYMBOL</h1>
<p>把过滤后的表达矩阵更改行名为基因的symbol，因为这个时候探针和基因是一对一关系了。</p>
<pre><code>exp_filter_no_symbol$probe_id &lt;- rownames(exp_filter_no_symbol)
exp_ids &lt;- merge(ids_filtered, exp_filter_no_symbol, by ='probe_id' )
rownames(exp_ids) &lt;- exp_ids$symbol
exp_sym &lt;- exp_ids[,-c(1:3)]
</code></pre>
<h1 id="11-画第一个样本和所有样本的基于表达量的图"><a class="markdownIt-Anchor" href="#11-画第一个样本和所有样本的基于表达量的图"></a> 11 画第一个样本和所有样本的基于表达量的图</h1>
<p>对第10步得到的表达矩阵进行探索，先画第一个样本的所有基因的表达量的boxplot,hist,density<br>
， 然后画所有样本的 这些图<br>
参考：<a href="http://bio-info-trainee.com/tmp/basic_visualization_for_expression_matrix.html" target="_blank" rel="noopener">http://bio-info-trainee.com/tmp/basic_visualization_for_expression_matrix.html</a><br>
理解ggplot2的绘图语法，数据和图形元素的映射关系</p>
<pre><code>boxplot(exp_sym$CLL11.CEL)
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-17-1.png" alt></p>
<pre><code>boxplot(exp_sym)
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-17-2.png" alt><br>
用ggplot2来画 ggplot2画图要改变数据形式</p>
<pre><code>library(reshape2)
exp_g &lt;- melt(exp_ids[,-c(1,3)], id.vars = 'symbol')
exp_g$group &lt;- rep(group$Disease, each = nrow(exp_sym))
colnames(exp_g)[2] &lt;- 'sample'
head(exp_g)

##    symbol    sample    value    group
## 1   MAPK3 CLL11.CEL 5.743132 progres.
## 2    TIE1 CLL11.CEL 2.285143 progres.
## 3 CYP2C19 CLL11.CEL 3.309294 progres.
## 4   CXCR5 CLL11.CEL 7.544884 progres.
## 5   DUSP1 CLL11.CEL 5.083793 progres.
## 6   MMP10 CLL11.CEL 3.252213 progres.
</code></pre>
<p>第一个样本的</p>
<pre><code>library(ggplot2)

## Registered S3 methods overwritten by 'ggplot2':
##   method         from 
##   [.quosures     rlang
##   c.quosures     rlang
##   print.quosures rlang

sample_1 &lt;- subset(exp_g, exp_g$sample=='CLL2.CEL')
head(sample_1)

##         symbol   sample    value  group
## 120191   MAPK3 CLL2.CEL 5.966942 stable
## 120192    TIE1 CLL2.CEL 2.350073 stable
## 120193 CYP2C19 CLL2.CEL 3.427736 stable
## 120194   CXCR5 CLL2.CEL 7.545673 stable
## 120195   DUSP1 CLL2.CEL 9.611601 stable
## 120196   MMP10 CLL2.CEL 3.380044 stable

p_s1 &lt;- ggplot(sample_1, aes(x = sample, y = value, fill = 'lightblue'))
p_s1 + geom_boxplot()
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-19-1.png" alt></p>
<pre><code>p_s1 + geom_violin()+geom_boxplot(fill = 'white')
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-19-2.png" alt></p>
<pre><code>ggplot(sample_1, aes(x = value, fill = 'lightblue'))+
  geom_histogram(bins = 500)
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-19-3.png" alt></p>
<pre><code>ggplot(sample_1, aes(x = value, fill = 'lightblue'))+
  geom_density()
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-19-4.png" alt><br>
下面是所有样本的</p>
<pre><code>p &lt;- ggplot(exp_g, aes(x = sample, y = value, fill = group))
p + geom_boxplot()
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-20-1.png" alt></p>
<pre><code>p + geom_violin()
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-20-2.png" alt></p>
<pre><code>ggplot(exp_g, aes(x=value,fill = group))+ geom_histogram(bins = 500)+
       facet_wrap(~group, nrow = 5)
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-20-3.png" alt></p>
<pre><code>ggplot(exp_g, aes(x=value,fill = group))+ geom_density()+
  facet_wrap(~group, nrow = 5)
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-20-4.png" alt> # 12<br>
理解统计学指标mean,median,max,min,sd,var,mad<br>
并计算出每个基因在所有样本的这些统计学指标，最后按照mad值排序，取top 50<br>
mad值的基因，得到列表</p>
<pre><code>head(exp_sym)

##         CLL11.CEL CLL12.CEL CLL13.CEL CLL14.CEL CLL15.CEL CLL16.CEL
## MAPK3    5.743132  6.219412  5.523328  5.340477  5.229904  4.920686
## TIE1     2.285143  2.291229  2.287986  2.295313  2.662170  2.278040
## CYP2C19  3.309294  3.318466  3.354423  3.327130  3.365113  3.568353
## CXCR5    7.544884  7.671801  7.474025  7.152482  6.902932  7.368660
## DUSP1    5.083793  7.610593  7.631311  6.518594  5.059087  4.855161
## MMP10    3.252213  3.288078  3.264168  3.217279  3.377575  3.365157
##         CLL17.CEL CLL18.CEL CLL19.CEL CLL20.CEL CLL21.CEL CLL22.CEL
## MAPK3    5.325348  4.826131  5.212387  5.285830  5.581859  6.251678
## TIE1     2.350796  2.325163  2.432635  2.256547  2.348389  2.263849
## CYP2C19  3.502440  3.394410  3.617099  3.279726  3.391734  3.306811
## CXCR5    6.456285  6.824862  7.304803  8.757756  6.695295  7.372185
## DUSP1    5.176975  4.874563  4.097580  9.250585  7.657463  7.683677
## MMP10    3.451987  3.392632  3.574332  3.249886  3.269541  3.213493
##         CLL23.CEL CLL24.CEL CLL2.CEL CLL3.CEL CLL4.CEL CLL5.CEL CLL6.CEL
## MAPK3    5.480752  5.216033 5.966942 5.397508 5.281720 5.414718 5.460626
## TIE1     2.264434  2.344079 2.350073 2.406846 2.341961 2.372928 2.356978
## CYP2C19  3.341444  3.798335 3.427736 3.453564 3.412944 3.411922 3.396466
## CXCR5    7.616749  6.839187 7.545673 8.802729 7.307752 7.491507 8.063202
## DUSP1    8.700667  5.546996 9.611601 5.732182 6.483191 6.072558 9.919125
## MMP10    3.330000  3.545541 3.380044 3.426736 3.311255 3.411775 3.376011
##         CLL7.CEL CLL8.CEL CLL9.CEL
## MAPK3   5.897821 5.253883 5.214155
## TIE1    2.222276 2.254772 2.358544
## CYP2C19 3.247276 3.255148 3.365746
## CXCR5   7.014543 8.019108 7.432331
## DUSP1   5.149411 4.989604 5.339848
## MMP10   3.218438 3.271324 3.291604

exp_mean &lt;- apply(exp_sym, 1, mean)
exp_median &lt;- apply(exp_sym,1, median)
exp_max &lt;- apply(exp_sym, 1, max)            
exp_min &lt;- apply(exp_sym, 1, min)
exp_sd &lt;- apply(exp_sym, 1, sd)
exp_var &lt;- apply(exp_sym, 1, var)
exp_md &lt;- apply(exp_sym, 1, mad)
exp_sta &lt;- data.frame(exp_mean, exp_median, exp_max, exp_min, exp_sd, exp_var, exp_md)
md_order &lt;- exp_sta[order(exp_sta$exp_md, decreasing = T),]
md_order[1:50,1:5]

##           exp_mean exp_median   exp_max  exp_min    exp_sd
## FAM30A    5.708006   6.649724  9.901761 2.422295 2.7988082
## IGF2BP3   4.801569   4.659068  8.899667 2.335350 2.2955054
## DMD       6.791259   7.036325 10.653183 3.060286 2.5247064
## TCF7      7.665692   7.697969 10.976634 4.547559 2.1667457
## SLAMF1    5.385746   5.392873  8.385662 3.016306 1.9537439
## FOS       7.204708   7.009703 10.831309 3.581185 2.1980961
## LGALS1    6.612549   6.738502  9.275395 2.548286 2.0956955
## IGLC1    10.912833  10.695933 14.895714 6.516660 2.6146697
## ZAP70     5.395807   5.223290  7.581484 3.230575 1.5860361
## FCN1      5.549464   5.280685  9.321022 3.221669 1.8535899
## LHFPL2    5.880325   5.831304  8.627377 3.202529 1.7771356
## HBB      10.451111  10.835714 13.089985 3.556112 2.6459011
## S100A8    7.054067   7.125176  9.789312 3.976454 1.6721426
## GUSBP11   9.152709   9.136234 12.387608 6.296077 1.9078900
## COBLL1    6.307016   6.672768  8.602673 3.764972 1.7079344
## VIPR1     5.001816   4.783675  7.947431 3.013597 1.7173512
## PCDH9     7.564731   8.589865 10.379183 2.128020 2.8787582
## IGH       7.504659   7.615107  9.961620 4.058258 1.6876278
## ZNF804A   5.482021   4.933040  8.417146 3.489773 1.6262582
## TRIB2     5.582121   5.382651  8.275038 3.262417 1.6285227
## OAS1      5.781610   5.841878  7.812439 2.844634 1.5555384
## CCL3      4.955042   4.528829  8.200438 2.892649 1.6758945
## GNLY      5.758612   5.702251  7.874737 3.112976 1.4291897
## CYBB      5.465935   4.990295  7.925110 3.741134 1.5086211
## VAMP5     5.129844   5.224719  6.787208 3.168429 1.2736710
## RNASE6    7.502004   7.475790  9.761536 4.561619 1.3692587
## RGS2      8.665894   8.690715 11.060867 5.593852 1.6673174
## PLXNC1    6.152678   6.011995  9.936706 4.282411 1.4519185
## CAPG      7.147032   7.287538  9.311853 4.295201 1.3599095
## RBM38     5.625046   5.984977  7.712013 2.364198 1.5115862
## VCAN      5.724099   5.551630  9.690421 3.425727 1.6784676
## APBB2     5.028141   4.991633  7.223220 3.534210 1.2951444
## ARF6      9.261574   9.274190 11.084527 7.417333 1.1470937
## TGFBI     7.719464   8.355828 10.336590 3.705677 2.1598336
## NR4A2     5.332218   4.905362 10.162592 3.535849 1.7782290
## S100A9    5.283652   5.121900  9.274989 3.360444 1.5913846
## ZNF266    9.162509   8.963549 10.825413 7.465138 1.1059916
## TSPYL2    5.334349   4.961360  9.606263 3.519564 1.5168915
## CLEC2B    6.703088   6.200192 10.689725 4.346883 1.6435564
## FLNA      7.261863   7.427031  8.892456 4.910564 1.2846904
## H1FX      9.481071   9.371750 11.448482 6.315160 1.4222048
## DUSP5     5.707280   5.662890  8.399445 3.096216 1.4659308
## DUSP6     6.220190   6.163704  9.349607 3.924092 1.6169735
## ANXA4     6.285188   6.575309  8.848398 3.290936 1.6485526
## LPL       5.451203   4.535271  8.736220 3.497206 1.8272643
## THEMIS2   7.060804   6.925227  8.676046 5.638975 0.9956062
## P2RY14    5.503758   5.449599  9.268856 2.776078 1.7700218
## ARHGAP44  5.823372   5.937855  8.171374 3.285610 1.3502894
## TNFSF9    5.038986   4.935596  7.080714 2.827961 1.2324676
## PFN2      5.427243   5.891385  7.621100 2.987904 1.3889489
</code></pre>
<h1 id="13-提取基因的表达矩阵子集绘制热图"><a class="markdownIt-Anchor" href="#13-提取基因的表达矩阵子集绘制热图"></a> 13 提取基因的表达矩阵子集，绘制热图</h1>
<p>根据第12步骤得到top 50<br>
mad值的基因列表来取表达矩阵的子集，并且热图可视化子表达矩阵。试试看其它5种热图的包的不同效果。</p>
<pre><code>names_50 &lt;- rownames(md_order[1:50,])
exp_mad_top50 &lt;- exp_sym[match(names_50, rownames(exp_sym)),]
pheatmap::pheatmap(log2(exp_mad_top50))
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-22-1.png" alt></p>
<pre><code>pheatmap::pheatmap(exp_mad_top50, scale=c(&quot;row&quot;))
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-22-2.png" alt> # 14<br>
取N个指标的交集并可视化：UpSetR包<br>
取不同统计学指标mean,median,max,mean,sd,var,mad的各top50基因列表，<br>
使用UpSetR包来看他们之间的overlap情况</p>
<pre><code>mean_50 &lt;- head(sort(exp_mean, decreasing = T),50)
median_50 &lt;- head(sort(exp_median, decreasing = T),50)
</code></pre>
<p>写函数完成上述重复问题问题</p>
<pre><code>sta_50 &lt;- function(x){
  x &lt;- head(sort((apply(exp_sym, 1, x)), decreasing = T),50)
  x_50 &lt;- x
  return(names((x_50)))
}
library('UpSetR')
</code></pre>
<p>取不含重复的并集</p>
<pre><code>sta_50_all &lt;- unique(c(sta_50(mean), sta_50(median),sta_50(max),sta_50(min),sta_50(sd),sta_50(var), sta_50(mad)))
</code></pre>
<p>转成upset需要的格式，也就是1和0分别代表</p>
<pre><code>u_mean &lt;- ifelse(sta_50_all %in% sta_50(mean), 1, 0)
</code></pre>
<p>再写个函数</p>
<pre><code>upset_sta &lt;- function(x){
   x &lt;- ifelse(sta_50_all %in% sta_50(x), 1, 0)
   u_x &lt;- x
   return(u_x)
}

upset_all &lt;- data.frame(sta_50_all, upset_sta(mean),upset_sta(median),
                        upset_sta(max),upset_sta(min),upset_sta(sd),upset_sta(var),upset_sta(mad))
?upset
upset(upset_all, nsets = 7, matrix.color = 'black',main.bar.color = 'green',
      sets.bar.color = 'red',point.size = 2, line.size = 0.8,
      shade.color = 'red', matrix.dot.alpha = 0.5) 
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-28-1.png" alt></p>
<h1 id="15-提取表型数据"><a class="markdownIt-Anchor" href="#15-提取表型数据"></a> 15 提取表型数据</h1>
<p>在第二步的基础上面提取CLL包里面的data(sCLLex) 数据对象的样本的表型数据。</p>
<pre><code>data(&quot;sCLLex&quot;)
pData(sCLLex)

##           SampleID  Disease
## CLL11.CEL    CLL11 progres.
## CLL12.CEL    CLL12   stable
## CLL13.CEL    CLL13 progres.
## CLL14.CEL    CLL14 progres.
## CLL15.CEL    CLL15 progres.
## CLL16.CEL    CLL16 progres.
## CLL17.CEL    CLL17   stable
## CLL18.CEL    CLL18   stable
## CLL19.CEL    CLL19 progres.
## CLL20.CEL    CLL20   stable
## CLL21.CEL    CLL21 progres.
## CLL22.CEL    CLL22   stable
## CLL23.CEL    CLL23 progres.
## CLL24.CEL    CLL24   stable
## CLL2.CEL      CLL2   stable
## CLL3.CEL      CLL3 progres.
## CLL4.CEL      CLL4 progres.
## CLL5.CEL      CLL5 progres.
## CLL6.CEL      CLL6 progres.
## CLL7.CEL      CLL7 progres.
## CLL8.CEL      CLL8 progres.
## CLL9.CEL      CLL9   stable
</code></pre>
<h1 id="16-对表达矩阵进行聚类画图添加临床表型数据"><a class="markdownIt-Anchor" href="#16-对表达矩阵进行聚类画图添加临床表型数据"></a> 16 对表达矩阵进行聚类画图，添加临床表型数据</h1>
<p>对所有样本的表达矩阵进行聚类并且绘图，然后添加样本的临床表型数据信息(更改样本名)<br>
#前面</p>
<pre><code>head(exp_sym)

##         CLL11.CEL CLL12.CEL CLL13.CEL CLL14.CEL CLL15.CEL CLL16.CEL
## MAPK3    5.743132  6.219412  5.523328  5.340477  5.229904  4.920686
## TIE1     2.285143  2.291229  2.287986  2.295313  2.662170  2.278040
## CYP2C19  3.309294  3.318466  3.354423  3.327130  3.365113  3.568353
## CXCR5    7.544884  7.671801  7.474025  7.152482  6.902932  7.368660
## DUSP1    5.083793  7.610593  7.631311  6.518594  5.059087  4.855161
## MMP10    3.252213  3.288078  3.264168  3.217279  3.377575  3.365157
##         CLL17.CEL CLL18.CEL CLL19.CEL CLL20.CEL CLL21.CEL CLL22.CEL
## MAPK3    5.325348  4.826131  5.212387  5.285830  5.581859  6.251678
## TIE1     2.350796  2.325163  2.432635  2.256547  2.348389  2.263849
## CYP2C19  3.502440  3.394410  3.617099  3.279726  3.391734  3.306811
## CXCR5    6.456285  6.824862  7.304803  8.757756  6.695295  7.372185
## DUSP1    5.176975  4.874563  4.097580  9.250585  7.657463  7.683677
## MMP10    3.451987  3.392632  3.574332  3.249886  3.269541  3.213493
##         CLL23.CEL CLL24.CEL CLL2.CEL CLL3.CEL CLL4.CEL CLL5.CEL CLL6.CEL
## MAPK3    5.480752  5.216033 5.966942 5.397508 5.281720 5.414718 5.460626
## TIE1     2.264434  2.344079 2.350073 2.406846 2.341961 2.372928 2.356978
## CYP2C19  3.341444  3.798335 3.427736 3.453564 3.412944 3.411922 3.396466
## CXCR5    7.616749  6.839187 7.545673 8.802729 7.307752 7.491507 8.063202
## DUSP1    8.700667  5.546996 9.611601 5.732182 6.483191 6.072558 9.919125
## MMP10    3.330000  3.545541 3.380044 3.426736 3.311255 3.411775 3.376011
##         CLL7.CEL CLL8.CEL CLL9.CEL
## MAPK3   5.897821 5.253883 5.214155
## TIE1    2.222276 2.254772 2.358544
## CYP2C19 3.247276 3.255148 3.365746
## CXCR5   7.014543 8.019108 7.432331
## DUSP1   5.149411 4.989604 5.339848
## MMP10   3.218438 3.271324 3.291604

group_list &lt;- as.character(pData(sCLLex)[,2])
colnames(exp_sym) &lt;- paste(group_list, 1:22, sep = '')
head(exp_sym)

##         progres.1  stable2 progres.3 progres.4 progres.5 progres.6
## MAPK3    5.743132 6.219412  5.523328  5.340477  5.229904  4.920686
## TIE1     2.285143 2.291229  2.287986  2.295313  2.662170  2.278040
## CYP2C19  3.309294 3.318466  3.354423  3.327130  3.365113  3.568353
## CXCR5    7.544884 7.671801  7.474025  7.152482  6.902932  7.368660
## DUSP1    5.083793 7.610593  7.631311  6.518594  5.059087  4.855161
## MMP10    3.252213 3.288078  3.264168  3.217279  3.377575  3.365157
##          stable7  stable8 progres.9 stable10 progres.11 stable12
## MAPK3   5.325348 4.826131  5.212387 5.285830   5.581859 6.251678
## TIE1    2.350796 2.325163  2.432635 2.256547   2.348389 2.263849
## CYP2C19 3.502440 3.394410  3.617099 3.279726   3.391734 3.306811
## CXCR5   6.456285 6.824862  7.304803 8.757756   6.695295 7.372185
## DUSP1   5.176975 4.874563  4.097580 9.250585   7.657463 7.683677
## MMP10   3.451987 3.392632  3.574332 3.249886   3.269541 3.213493
##         progres.13 stable14 stable15 progres.16 progres.17 progres.18
## MAPK3     5.480752 5.216033 5.966942   5.397508   5.281720   5.414718
## TIE1      2.264434 2.344079 2.350073   2.406846   2.341961   2.372928
## CYP2C19   3.341444 3.798335 3.427736   3.453564   3.412944   3.411922
## CXCR5     7.616749 6.839187 7.545673   8.802729   7.307752   7.491507
## DUSP1     8.700667 5.546996 9.611601   5.732182   6.483191   6.072558
## MMP10     3.330000 3.545541 3.380044   3.426736   3.311255   3.411775
##         progres.19 progres.20 progres.21 stable22
## MAPK3     5.460626   5.897821   5.253883 5.214155
## TIE1      2.356978   2.222276   2.254772 2.358544
## CYP2C19   3.396466   3.247276   3.255148 3.365746
## CXCR5     8.063202   7.014543   8.019108 7.432331
## DUSP1     9.919125   5.149411   4.989604 5.339848
## MMP10     3.376011   3.218438   3.271324 3.291604

t.exp &lt;- t(exp_sym)
t.exp[1:5,1:5]

##              MAPK3     TIE1  CYP2C19    CXCR5    DUSP1
## progres.1 5.743132 2.285143 3.309294 7.544884 5.083793
## stable2   6.219412 2.291229 3.318466 7.671801 7.610593
## progres.3 5.523328 2.287986 3.354423 7.474025 7.631311
## progres.4 5.340477 2.295313 3.327130 7.152482 6.518594
## progres.5 5.229904 2.662170 3.365113 6.902932 5.059087

hc &lt;- hclust(dist(t.exp))
plot(as.dendrogram(hc))
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-30-1.png" alt><br>
用factoextra包画</p>
<pre><code>exp_cluster &lt;- t(exp_sym)
exp_clust_dist &lt;- dist(exp_cluster, method = 'euclidean')
hc &lt;- hclust(exp_clust_dist,'ward.D')

library(factoextra)

## Welcome! Related Books: `Practical Guide To Cluster Analysis in R` at https://goo.gl/13EFCZ

fviz_dend(hc, k=4, cex = 0.5,
          k_colors = c(&quot;#2E9FDF&quot;, &quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;),
          color_labels_by_k = TRUE, rect = TRUE)
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-32-1.png" alt> # 17<br>
对所有样本的表达矩阵进行PCA分析并且绘图，同样要添加表型信息</p>
<pre><code>library(devtools)
install_github('sinhrks/ggfortify')

## Skipping install of 'ggfortify' from a github remote, the SHA1 (107768f6) has not changed since last install.
##   Use `force = TRUE` to force installation

library(ggfortify)
df &lt;- as.data.frame(t(exp_sym))
df$group &lt;- group$Disease
autoplot(prcomp(df[,1:(ncol(df)-1)]), data=df, 
         label = TRUE, colour = 'group')
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-33-1.png" alt><br>
#18.根据表达矩阵及样本分组信息进行批量T检验，得到检验结果表格</p>
<pre><code>dat &lt;- exp_sym
group_list &lt;- as.factor(group_list)
group1 &lt;- which(group_list == levels(group_list)[1])
group2 &lt;- which(group_list == levels(group_list)[2])
dat1 &lt;- dat[,group1]
dat2 &lt;- dat[,group2]
dat &lt;- cbind(dat1, dat2)
pvals &lt;- apply(dat, 1, function(x){
  t.test(as.numeric(x)~group_list)$p.value
})
head(pvals)

##      MAPK3       TIE1    CYP2C19      CXCR5      DUSP1      MMP10 
## 0.65221728 0.32547921 0.10930650 0.52972986 0.11181740 0.08771106

p.adj &lt;- p.adjust(pvals, method = 'BH')
avg_1 &lt;- log2(rowMeans(dat1))

## Warning: NaNs produced

avg_2 &lt;- log2(rowMeans(dat2))

## Warning: NaNs produced

log2FC &lt;- avg_2-avg_1
deg_t.test &lt;- cbind(avg_1, avg_2, log2FC, pvals, p.adj)
deg_t.test &lt;- deg_t.test[order(deg_t.test[,4]),]
head(deg_t.test)

##           avg_1    avg_2      log2FC        pvals     p.adj
## ST14   2.491256 2.364128 -0.12712815 0.0001236326 0.4156259
## LTB    2.961047 2.807431 -0.15361585 0.0002103122 0.4156259
## CORO1A 3.239158 3.149793 -0.08936553 0.0002370691 0.4156259
## PPM1D  2.356110 2.425399  0.06928926 0.0004783848 0.4156259
## ORAI2  2.459287 2.199910 -0.25937653 0.0005244971 0.4156259
## GNAI2  3.319264 3.275868 -0.04339579 0.0005434369 0.4156259

class(deg_t.test)

## [1] &quot;matrix&quot;
</code></pre>
<h1 id="19使用limma包对表达矩阵及样本分组信息进行差异分析得到差异分析表格"><a class="markdownIt-Anchor" href="#19使用limma包对表达矩阵及样本分组信息进行差异分析得到差异分析表格"></a> 19.使用limma包对表达矩阵及样本分组信息进行差异分析，得到差异分析表格，</h1>
<p>重点看logFC和P值，画个火山图(就是logFC和-log10(P值)的散点图)。 ## 1<br>
构建设计矩阵design matrix</p>
<pre><code>library(limma)

## 
## Attaching package: 'limma'

## The following object is masked from 'package:BiocGenerics':
## 
##     plotMA

design &lt;- model.matrix(~0+factor(group_list))
colnames(design) &lt;- levels(factor(group_list))
rownames(design) &lt;- colnames(exp_sym)
design

##            progres. stable
## progres.1         1      0
## stable2           0      1
## progres.3         1      0
## progres.4         1      0
## progres.5         1      0
## progres.6         1      0
## stable7           0      1
## stable8           0      1
## progres.9         1      0
## stable10          0      1
## progres.11        1      0
## stable12          0      1
## progres.13        1      0
## stable14          0      1
## stable15          0      1
## progres.16        1      0
## progres.17        1      0
## progres.18        1      0
## progres.19        1      0
## progres.20        1      0
## progres.21        1      0
## stable22          0      1
## attr(,&quot;assign&quot;)
## [1] 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$`factor(group_list)`
## [1] &quot;contr.treatment&quot;

fit &lt;- lmFit(exp_sym, design)
</code></pre>
<h2 id="2-构建比较矩阵"><a class="markdownIt-Anchor" href="#2-构建比较矩阵"></a> 2 构建比较矩阵</h2>
<pre><code>contrast.matrix &lt;- makeContrasts(paste0(unique(group_list), 
                            collapse = '-'), levels = design)
fit2 &lt;- contrasts.fit(fit, contrast.matrix)
fit3 &lt;- eBayes(fit2)
</code></pre>
<h2 id="3差异表达矩阵获取"><a class="markdownIt-Anchor" href="#3差异表达矩阵获取"></a> 3差异表达矩阵获取</h2>
<pre><code>mtx &lt;- topTable(fit3, coef = 1, n=Inf)
DEG_mtx &lt;- na.omit(mtx)
dim(mtx)

## [1] 8585    6

dim(DEG_mtx)

## [1] 8585    6

head(DEG_mtx)

##              logFC  AveExpr         t      P.Value  adj.P.Val        B
## TBC1D2B -1.0284628 5.620700 -5.837412 8.241439e-06 0.02237023 3.351806
## CLIC1    0.9888221 9.954273  5.772861 9.560444e-06 0.02237023 3.230776
## DLEU1    1.8301554 6.950685  5.740842 1.029277e-05 0.02237023 3.170506
## SH3BP2  -1.3835699 4.463438 -5.735395 1.042294e-05 0.02237023 3.160238
## GPM6A    2.5471980 6.915045  5.043131 5.269777e-05 0.08731675 1.821536
## YTHDC2  -0.5187135 7.602354 -4.873850 7.879310e-05 0.08731675 1.485255

#write.csv(DEG_mtx,&quot;DEG_mtx.csv&quot;,quote = F)
</code></pre>
<h2 id="4火山图"><a class="markdownIt-Anchor" href="#4火山图"></a> 4火山图</h2>
<h3 id="第一步设定阈值界定上调下调和不表达的基因"><a class="markdownIt-Anchor" href="#第一步设定阈值界定上调下调和不表达的基因"></a> 第一步，设定阈值，界定上调下调和不表达的基因</h3>
<pre><code>DEG &lt;- DEG_mtx
logFC_cutoff &lt;- with(DEG, mean(abs(logFC))+2*sd(abs(logFC)))
DEG$change = as.factor(ifelse(DEG$P.Value &lt; 0.05 &amp; abs(DEG$logFC) &gt; logFC_cutoff,
                              ifelse(DEG$logFC &gt; logFC_cutoff ,'UP','DOWN'),'NOT')
)
</code></pre>
<blockquote>
<p>这是两个<code>ifelse</code>判断嵌套。先了解<code>ifelse</code>的结构，ifelse（条件，yes，no），如果满足条件，那么返回yes/或者执行yes所处的下一个命令；反之返回no<br>
这里外层的ifelse中<code>DEG$P.Value &lt; 0.05 &amp; abs(DEG$logFC) &gt; logFC_cutoff</code>是判断条件，这个就是看p值和logFC是不是达到了他们设定的阈值【p是0.05，logFC是logFC_cutoff】，如果达到了就进行下一个ifelse，达不到就返回NOT；<br>
第二层ifelse也是上来一个条件：<code>DEG$logFC &gt; logFC_cutoff</code>，如果达到了，就返回UP即上调基因，达不到就是下调DOWN<br>
最后将判断结果转位因子型，得到DOWN、UP、NOT的三种因子</p>
</blockquote>
<h3 id="第二步设定火山图标题"><a class="markdownIt-Anchor" href="#第二步设定火山图标题"></a> 第二步，设定火山图标题</h3>
<pre><code>this_tile &lt;- paste0('Cutoff for logFC is ',round(logFC_cutoff,3),
                    '\nThe number of up gene is ',nrow(DEG[DEG$change =='UP',]) ,
                    '\nThe number of down gene is ',nrow(DEG[DEG$change =='DOWN',])
)
</code></pre>
<h3 id="第三步画图"><a class="markdownIt-Anchor" href="#第三步画图"></a> 第三步，画图</h3>
<pre><code>g = ggplot(data=DEG, aes(x=logFC, y=-log10(P.Value), color=change)) +
  geom_point(alpha=0.4, size=1.75) +
  theme_set(theme_set(theme_bw(base_size=20)))+
  xlab(&quot;log2 fold change&quot;) + ylab(&quot;-log10 p-value&quot;) +
  ggtitle( this_tile ) + theme(plot.title = element_text(size=15,hjust = 0.5))+
  scale_colour_manual(values = c('blue','black','red')) ## corresponding to the levels(res$change)
print(g)
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-40-1.png" alt> ###<br>
第四步，画个漂亮的图</p>
<pre><code>P_volcano=ggplot(DEG,aes(x=logFC,y=-log10(P.Value)))+
  geom_point(aes(color=change))+
  #设置点的颜色
  scale_color_manual(values =c(&quot;UP&quot; = &quot;red&quot;, &quot;DOWN&quot; = &quot;blue&quot;, &quot;NOT&quot; = &quot;grey&quot;))+
  labs(x=&quot;log2FC&quot;,y=&quot;-log10FDR&quot;)+
  #增加阈值线:分别对应FDR=0.05,|log2FC|=1
  geom_hline(yintercept=-log10(0.05),linetype=4)+
  geom_vline(xintercept=c(-1,1),linetype=4)+
  xlim(-3,3)+
  theme(plot.title = element_text(size = 25,face = &quot;bold&quot;, vjust = 0.5, hjust = 0.5),
        legend.title = element_blank(),
        legend.text = element_text(size = 18, face = &quot;bold&quot;),
        legend.position = 'right',
        legend.key.size=unit(0.8,'cm'),
        axis.ticks.x=element_blank(),
        axis.text.x=element_text(size = 15,face = &quot;bold&quot;, vjust = 0.5, hjust = 0.5),
        axis.text.y=element_text(size = 15,face = &quot;bold&quot;, vjust = 0.5, hjust = 0.5),
        axis.title.x = element_text(size = 20,face = &quot;bold&quot;, vjust = 0.5, hjust = 0.5),
        axis.title.y = element_text(size = 20,face = &quot;bold&quot;, vjust = 0.5, hjust = 0.5),
        panel.background = element_rect(fill = &quot;transparent&quot;,colour = &quot;black&quot;),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(),
        plot.background = element_rect(fill = &quot;transparent&quot;,colour = &quot;black&quot;))
P_volcano
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-41-1.png" alt><br>
#20.对T检验结果的P值和limma包差异分析的P值画散点图，看看哪些基因相差很大</p>
<pre><code>deg_t.test &lt;- as.data.frame(deg_t.test)
t_limma_pval &lt;- cbind(deg_t.test,DEG)[,c(4,9)]
head(t_limma_pval)

##               pvals      P.Value
## ST14   0.0001236326 8.241439e-06
## LTB    0.0002103122 9.560444e-06
## CORO1A 0.0002370691 1.029277e-05
## PPM1D  0.0004783848 1.042294e-05
## ORAI2  0.0005244971 5.269777e-05
## GNAI2  0.0005434369 7.879310e-05

plot(t_limma_pval)
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-42-1.png" alt></p>
<pre><code>pheatmap::pheatmap(cor(t_limma_pval))
</code></pre>
<p><img src="try_files/figure-markdown_strict/unnamed-chunk-42-2.png" alt><br>
#看哪些基因在两种方法种的p值差异比较大</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/R/">R</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/生物信息学/">生物信息学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/统计/">统计</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->



  
    <article id="post-网页右上角显示github" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2019/04/29/网页右上角显示github/">github图表加到网页角落</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2019/04/29/网页右上角显示github/" class="article-date">
	  <time datetime="2019-04-29T06:44:53.676Z" itemprop="datePublished">四月 29, 2019</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/hexo/">hexo</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-去这里或这里找喜欢的样式"><a class="markdownIt-Anchor" href="#1-去这里或这里找喜欢的样式"></a> 1 去<a href="https://github.blog/2008-12-19-github-ribbons/" target="_blank" rel="noopener">这里</a>或<a href="http://tholman.com/github-corners/" target="_blank" rel="noopener">这里</a>找喜欢的样式</h1>
<p>找一个合适并喜欢的样式，复制方框的代码<br>
前面的ribbons容易位置错误</p>
<h1 id="2-打开主题目录下的_layoutswig文件文件"><a class="markdownIt-Anchor" href="#2-打开主题目录下的_layoutswig文件文件"></a> 2 打开主题目录下的_layout.swig文件文件</h1>
<p>\themes\next\layout<br>
打开后，在<code>&lt;div class=&quot;headband&quot;&gt;&lt;/div&gt;</code>下面（大概23行）</p>
<p>粘贴刚才复制的代码，改成你自己的github名字就可以了。</p>
<p>另外，这里可以延伸。放自己可以链接的外地址，并加上图片，道理一样。</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/hexo/">hexo</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/github/">github</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/">hexo</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->



  
    <article id="post-同一个github账户绑定两个域名" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2019/04/29/同一个github账户绑定两个域名/">同一个github账户绑定两个域名</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2019/04/29/同一个github账户绑定两个域名/" class="article-date">
	  <time datetime="2019-04-29T04:45:46.252Z" itemprop="datePublished">四月 29, 2019</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/hexo/">hexo</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>一个github账号可以建立很多仓库，但是只能有一个个人主页仓库，其余都是项目仓库。主页仓库就是<code>你的名字.github.io这个</code>，其余的就是https://github.com/hyinli/项目名称这种。<br>
前面已经建立个人主页仓库并绑定域名，现在再利用项目仓库网页并绑定个人域名。具体如下</p>
<h1 id="1-先建立个人项目仓库比如名字kk"><a class="markdownIt-Anchor" href="#1-先建立个人项目仓库比如名字kk"></a> 1 先建立个人项目仓库比如名字kk</h1>
<h1 id="2-建gh-pages分支不能用master"><a class="markdownIt-Anchor" href="#2-建gh-pages分支不能用master"></a> 2 建<code>gh-pages</code>分支（不能用master）</h1>
<p><img src="https://upload-images.jianshu.io/upload_images/7976641-3a8c25bdb79f5fce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="建立gh-pages分支"></p>
<h1 id="3-域名解析"><a class="markdownIt-Anchor" href="#3-域名解析"></a> 3 域名解析</h1>
<p><img src="https://upload-images.jianshu.io/upload_images/7976641-fb1673e5a704fce4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="域名解析"><br>
其中，IP这样获得<br>
<code>ping 你的名字.github.io</code></p>
<h1 id="4-根目录的source文件夹见cname文件"><a class="markdownIt-Anchor" href="#4-根目录的source文件夹见cname文件"></a> 4 根目录的source文件夹见CNAME文件</h1>
<p>首行写入你要绑定的域名，可以带www<br>
说明：网上建议裸域名。但是是可以带www的，只是项目仓库必须建在<code>gh-pages</code>分支，master分支会一直提示错误。</p>
<h1 id="5-根目录的configyml文件修改"><a class="markdownIt-Anchor" href="#5-根目录的configyml文件修改"></a> 5 根目录的’config.yml文件，修改</h1>
<p><img src="https://upload-images.jianshu.io/upload_images/7976641-1bbe5d185b4a7703.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="config.yml修改"></p>
<h1 id="6-github-项目仓库setting"><a class="markdownIt-Anchor" href="#6-github-项目仓库setting"></a> 6 github 项目仓库，setting</h1>
<p>填入你的域名，带www<br>
—The end—</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/hexo/">hexo</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/github/">github</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/">hexo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/个人域名/">个人域名</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->



  
    <article id="post-github两个账户不能进行push的解决办法" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2019/04/28/github两个账户不能进行push的解决办法/">github两个账户不能进行push的解决办法</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2019/04/28/github两个账户不能进行push的解决办法/" class="article-date">
	  <time datetime="2019-04-28T02:14:02.369Z" itemprop="datePublished">四月 28, 2019</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/github/">github</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>因为邮箱和本地电脑问题，我重新申请了github账号，但使用新账户申请博客的时候push出现问题，无法进行推送。windows系统解决办法如下</p>
<p>搜索“凭据管理器”，进入windows凭据，普通凭据，<br>
然后把三个与github相关的删除即可。</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/github/">github</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/github/">github</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->



  
    <article id="post-github+hexo+个人域名建立个人网站" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2019/04/28/github+hexo+个人域名建立个人网站/">github+hexo+个人域名建立个人网站</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2019/04/28/github+hexo+个人域名建立个人网站/" class="article-date">
	  <time datetime="2019-04-28T02:08:18.836Z" itemprop="datePublished">四月 28, 2019</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/hexo/">hexo</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>写在前面：<br>
之前一直用hugo结合github使用，这次尝试hexo，发现非常喜欢，可塑性很强。<br>
<strong>主要记录一些坑</strong><br>
这个博文主要是大体记录流程，至于中间参考过的3篇建站文章会列出来。总之根据这篇博文你可以完全搭建属于自己的个性网站。</p>
</blockquote>
<h1 id="1-github的工作"><a class="markdownIt-Anchor" href="#1-github的工作"></a> 1 github的工作</h1>
<h2 id="1-注册github不再描述"><a class="markdownIt-Anchor" href="#1-注册github不再描述"></a> 1 注册github，不再描述</h2>
<h2 id="2-建立repo"><a class="markdownIt-Anchor" href="#2-建立repo"></a> 2 建立repo</h2>
<p>记得repo名字要和github id一样。也就是如果你的id是hello,那么要申请一个hello.github.io的repo。</p>
<h1 id="2-本地电脑的工作"><a class="markdownIt-Anchor" href="#2-本地电脑的工作"></a> 2 本地电脑的工作</h1>
<p>请参考https://www.jianshu.com/p/189fd945f38f<br>
大体分为以下几步</p>
<h2 id="1下载安装git"><a class="markdownIt-Anchor" href="#1下载安装git"></a> 1<a href="https://gitforwindows.org/" target="_blank" rel="noopener">下载安装Git</a></h2>
<h2 id="2下载安装nodejs"><a class="markdownIt-Anchor" href="#2下载安装nodejs"></a> 2<a href="https://nodejs.org/en/" target="_blank" rel="noopener">下载安装node.js</a></h2>
<h2 id="3安装hexo并进行初始化"><a class="markdownIt-Anchor" href="#3安装hexo并进行初始化"></a> 3安装hexo并进行初始化</h2>
<p>选择某个盘，创建hexo文件夹，别的名字也行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo</span><br><span class="line">hexo init</span><br></pre></td></tr></table></figure>
<h2 id="4修改configyml文件关键是theme"><a class="markdownIt-Anchor" href="#4修改configyml文件关键是theme"></a> 4修改config.yml文件，关键是theme</h2>
<p>稍许，hexo文件夹里会出现很多内容。用notepad++打开<code>_config.yml</code>文件，修改<br>
title（博客名字）<br>
subtite(副标题）<br>
author（作者名字）<br>
关键是theme ，系统默认是landscape，也可以<a href="https://hexo.io/themes/" target="_blank" rel="noopener">查看更多主题</a>。个人比较喜欢next主题，另外，<br>
black-blue, BlueLake, pure主题也不错。每个主题都会告诉你下载方式，直接参照进行就行，手动下载或git clone下载。<br>
其余部分可以暂时不动。（现在也可以更改，看2.7.1）下载后的主题会存放在hexo下的themes文件夹里。</p>
<blockquote>
<p>这个地方是hugo是不一样的处理方式，hugo要吧主题的example文件下的内容进行copy替换。而hexo是同时处理根目录和主题目录。</p>
</blockquote>
<h2 id="5生成网站并在线查看"><a class="markdownIt-Anchor" href="#5生成网站并在线查看"></a> 5生成网站并在线查看</h2>
<p>现在就可以在本地电脑查看雏形了.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>
<p>若要查看更多hexo命令，请移步<a href="https://segmentfault.com/a/1190000002632530" target="_blank" rel="noopener">查看更多hexo命令</a><br>
hexo s后，会提示端口，复制就可以本地访问，都是localhost：4000</p>
<h2 id="6-写第一篇文章"><a class="markdownIt-Anchor" href="#6-写第一篇文章"></a> 6 写第一篇文章</h2>
<blockquote>
<p>刚才说了hexo是根目录和主题下目录多要修改一些内容。所以，往下会加上根目录（代表\hexo），主题目录代表（\hexo\themes\next）。</p>
</blockquote>
<p>写文章是在根目录：\hexo\source_posts。如果你在简书有文章，可以直接复制，可以完美识别。记得如果用toc功能，需要#后又空格，否则不被识别。<br>
写完后，再次hexo s既可以看到更新。</p>
<h2 id="7-部署到github"><a class="markdownIt-Anchor" href="#7-部署到github"></a> 7 部署到github</h2>
<h3 id="1-更改根目录_configyml最好需要有以下内容"><a class="markdownIt-Anchor" href="#1-更改根目录_configyml最好需要有以下内容"></a> 1 更改根目录_config.yml，最好需要有以下内容</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: https://github.com/你的名字/你的名字.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>
<h3 id="2-安装hexo-deployer-git自动部署发布工具"><a class="markdownIt-Anchor" href="#2-安装hexo-deployer-git自动部署发布工具"></a> 2 安装<a href="https://github.com/hexojs/hexo-deployer-git" target="_blank" rel="noopener">hexo-deployer-git</a>自动部署发布工具</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git  --save</span><br></pre></td></tr></table></figure>
<h3 id="3-发布到github"><a class="markdownIt-Anchor" href="#3-发布到github"></a> 3 发布到github</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>
<p>如果初次使用需要输入用户名密码之类，牢记，这样你的github repo就会有你刚才push的内容</p>
<h3 id="4-在线访问"><a class="markdownIt-Anchor" href="#4-在线访问"></a> 4 在线访问</h3>
<p><a href="https://xn--6qqv7i7thbp4a.github.io/" target="_blank" rel="noopener">https://你的名字.github.io/</a><br>
我的是https://hyinli.github.io/可以查看</p>
<h1 id="3主题配置"><a class="markdownIt-Anchor" href="#3主题配置"></a> 3主题配置</h1>
<p>这部分花费时间比较多，所以单列出来。<br>
现在雏形已经具备，接下来要进行主题配置，添加一些比较有用的插件等。<a href="https://hexo.io/plugins/" target="_blank" rel="noopener">hexo有很多插件</a><br>
各种各样的配置，一定有你喜欢的。<br>
这部分主要参考这两篇文章,非常详尽，如果还有你想不到的内容，那就单项google搜索。<br>
<a href="https://www.zdaiot.com/%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/Windows%E4%B8%8B%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/" target="_blank" rel="noopener">Windows下使用hexo搭建博客</a><br>
<a href="https://blog.enjoytoshare.club/article/hexo-do-optimization.html" target="_blank" rel="noopener">Hexo+NexT搭建博客拥抱舒爽</a><br>
主要包括有<br>
语言，类别，标签，菜单，头像，统计在线时间，访问量，等。这些不再赘述。</p>
<h2 id="1-开启文章目录"><a class="markdownIt-Anchor" href="#1-开启文章目录"></a> 1 开启文章目录</h2>
<p>请参考<a href="https://blog.enjoytoshare.club/article/hexo-do-catalog.html" target="_blank" rel="noopener">Hexo博客NexT主题开启文章目录和调整样式</a><br>
nextT本身有目录的，我们需要开启它</p>
<h3 id="1-修改customstyl"><a class="markdownIt-Anchor" href="#1-修改customstyl"></a> 1 修改custom.styl</h3>
<p><code>themes/next/source/css/_custom</code><br>
notpad++打开，添加以下内容<br>
打开及调整目录字体</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#文章目录默认展开</span><br><span class="line">//文章目录默认展开</span><br><span class="line">.post-toc .nav .nav-child &#123; display: block; &#125;</span><br><span class="line">#目录字体大小调整</span><br><span class="line">.post-toc ol &#123;  </span><br><span class="line">  font-size : 13px;     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改主题配置文件<code>themes/next/_config.yml</code></p>
<p>目录换行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">toc:</span><br><span class="line">  enable: true  </span><br><span class="line">  wrap: true</span><br></pre></td></tr></table></figure>
<p>#文章目录无法锚定的问题<br>
假如出现，文章目录生成，但是就不能链接到正确的地方。如果自己的操作没错误，那就执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean命令</span><br><span class="line">#然后</span><br><span class="line">hexo d -g</span><br></pre></td></tr></table></figure>
<h1 id="4-被百度和google搜索引擎能搜索到参考上述两篇文章"><a class="markdownIt-Anchor" href="#4-被百度和google搜索引擎能搜索到参考上述两篇文章"></a> 4 被百度和google搜索引擎能搜索到，参考上述两篇文章</h1>
<h1 id="5-绑定个人域名"><a class="markdownIt-Anchor" href="#5-绑定个人域名"></a> 5 绑定个人域名</h1>
<h2 id="1-购买个人域名"><a class="markdownIt-Anchor" href="#1-购买个人域名"></a> 1 购买个人域名</h2>
<p>我是阿里云买的</p>
<h2 id="2-域名解析"><a class="markdownIt-Anchor" href="#2-域名解析"></a> 2 域名解析</h2>
<p>设置如下<br>
<img src="https://upload-images.jianshu.io/upload_images/7976641-ac066dbbf3c6c003.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="域名解析"></p>
<h2 id="3-hexo设置"><a class="markdownIt-Anchor" href="#3-hexo设置"></a> 3 Hexo设置</h2>
<p><code>\hexo\source</code>下创建CNAME文件（没有后缀，且全部大写），notepad++打开，首行写上你购买的域名<br>
我的就是<br>
<a href="http://www.ucco.net" target="_blank" rel="noopener">http://www.ucco.net</a><br>
网上有人建议必要加www 但是这样设置后 看起来非常不好看，我又加上了</p>
<h2 id="4-github设置"><a class="markdownIt-Anchor" href="#4-github设置"></a> 4 github设置</h2>
<p>再回到github，打开<code>你的名字.github.io</code>中的setteings，修正以下内容<br>
<code>custom domain</code>中，<br>
<img src="https://upload-images.jianshu.io/upload_images/7976641-1af6441085da394a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="github设置"></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/hexo/">hexo</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo-github，域名，个人网站/">hexo github，域名，个人网站</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->



  
    <article id="post-生信技能树R作业中" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2019/04/27/生信技能树R作业中/">生信技能树R作业答案-中</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2019/04/27/生信技能树R作业中/" class="article-date">
	  <time datetime="2019-04-27T12:10:13.244Z" itemprop="datePublished">四月 27, 2019</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/R/">R</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>#<a href="http://www.bio-info-trainee.com/3750.html" target="_blank" rel="noopener">作业在这里</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">rm(list = ls()) </span><br><span class="line">options()$repos </span><br><span class="line">options()$BioC_mirror</span><br><span class="line">options(BioC_mirror=&quot;https://mirrors.ustc.edu.cn/bioc/&quot;)</span><br><span class="line">options(&quot;repos&quot; = c(CRAN=&quot;https://mirrors.tuna.tsinghua.edu.cn/CRAN/&quot;))</span><br><span class="line">options()$repos </span><br><span class="line">options()$BioC_mirror</span><br><span class="line"># https://bioconductor.org/packages/release/bioc/html/GEOquery.html</span><br><span class="line">if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))</span><br><span class="line">  install.packages(&quot;BiocManager&quot;)</span><br><span class="line">BiocManager::install(&quot;KEGG.db&quot;,ask = F,update = F)</span><br><span class="line">BiocManager::install(c(&quot;GSEABase&quot;,&quot;GSVA&quot;,&quot;clusterProfiler&quot; ),ask = F,update = F)</span><br><span class="line">BiocManager::install(c(&quot;GEOquery&quot;,&quot;limma&quot;,&quot;impute&quot; ),ask = F,update = F)</span><br><span class="line">BiocManager::install(c(&quot;genefu&quot;,&quot;org.Hs.eg.db&quot;,&quot;hgu133plus2.db&quot; ),ask = F,update = F)</span><br><span class="line">options()$repos</span><br><span class="line">install.packages(&apos;WGCNA&apos;)</span><br><span class="line">install.packages(c(&quot;FactoMineR&quot;, &quot;factoextra&quot;))</span><br><span class="line">install.packages(c(&quot;ggplot2&quot;, &quot;pheatmap&quot;,&quot;ggpubr&quot;))</span><br><span class="line">library(&quot;FactoMineR&quot;)</span><br><span class="line">library(&quot;factoextra&quot;)</span><br><span class="line">library(GSEABase)</span><br><span class="line">library(GSVA)</span><br><span class="line">library(clusterProfiler)</span><br><span class="line">library(genefu)</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggpubr)</span><br><span class="line">library(hgu133plus2.db)</span><br><span class="line">library(limma)</span><br><span class="line">library(org.Hs.eg.db)</span><br><span class="line">library(pheatmap)</span><br></pre></td></tr></table></figure>
<h1 id="task1-通过r注释包从ensemble到symbol"><a class="markdownIt-Anchor" href="#task1-通过r注释包从ensemble到symbol"></a> Task1: 通过R注释包从ensemble到symbol</h1>
<blockquote>
<p>请根据R包org.Hs.eg.db找到下面ensembl 基因ID 对应的基因名(symbol)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># ENSG00000000003.13</span><br><span class="line"># ENSG00000000005.5</span><br><span class="line"># ENSG00000000419.11</span><br><span class="line"># ENSG00000000457.12</span><br><span class="line"># ENSG00000000460.15</span><br><span class="line"># ENSG00000000938.11</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">library(org.Hs.eg.db)</span><br><span class="line">ls(&quot;package:org.Hs.eg.db&quot;)</span><br><span class="line">g2s &lt;- toTable(org.Hs.egSYMBOL)</span><br><span class="line">g2e &lt;- toTable(org.Hs.egENSEMBL)</span><br><span class="line">head(g2s)</span><br><span class="line">head(g2e)</span><br><span class="line">g2se &lt;- merge(g2s, g2e, by=&apos;gene_id&apos;)</span><br><span class="line">head(g2se)</span><br><span class="line">ensID1 &lt;- c(&quot;ENSG00000000003.13&quot;,&quot;ENSG00000000005.5&quot;,&quot;ENSG00000000419.11&quot;,</span><br><span class="line">           &quot;ENSG00000000457.12&quot;,&quot;ENSG00000000460.15&quot;,&quot;ENSG00000000938.11&quot;)</span><br><span class="line">ensID &lt;- data.frame(ensID1)</span><br></pre></td></tr></table></figure>
<h2 id="method1for循环"><a class="markdownIt-Anchor" href="#method1for循环"></a> Method1:for循环</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">for (i in 1:nrow(ensID)) &#123;</span><br><span class="line">  ens_i &lt;- strsplit(as.character(ensID[i,1]),&apos;.&apos;,fixed = TRUE)[[1]][1]</span><br><span class="line">  ensID[i,2]&lt;-ens_i</span><br><span class="line">&#125;</span><br><span class="line">ensID$ensembl_id  &lt;- NULL</span><br><span class="line">colnames(ensID)[1] &lt;- &apos;ensembl_id&apos; </span><br><span class="line">ensID_last &lt;- merge(ensID, g2se, &apos;ensembl_id&apos;)</span><br><span class="line">ensID_last</span><br></pre></td></tr></table></figure>
<h2 id="method2apply函数"><a class="markdownIt-Anchor" href="#method2apply函数"></a> Method2:apply函数</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ensID$ensembl_id &lt;- unlist(lapply(ensID1,  function(x) &#123;strsplit(as.character(x),&apos;.&apos;,fixed = TRUE)[[1]][1]</span><br><span class="line">  &#125;))</span><br><span class="line">ensID_last2 &lt;- merge(ensID, g2se,&quot;ensembl_id&quot;)</span><br></pre></td></tr></table></figure>
<h1 id="task2由探针找到对应的基因名"><a class="markdownIt-Anchor" href="#task2由探针找到对应的基因名"></a> Task2:由探针找到对应的基因名</h1>
<blockquote>
<p>根据R包hgu133a.db找到下面探针对应的基因名(symbol)<br>
053_at<br>
117_at<br>
121_at<br>
1255_g_at<br>
1316_at<br>
1320_at<br>
1405_i_at<br>
1431_at<br>
1438_at<br>
1487_at<br>
1494_f_at<br>
1598_g_at<br>
160020_at<br>
1729_at<br>
177_at</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library(hgu133a.db)</span><br><span class="line">ids &lt;- toTable(hgu133aSYMBOL)</span><br><span class="line">head(ids)</span><br><span class="line">myids &lt;- read.table(file = &quot;my_probe_ids.txt&quot;)</span><br><span class="line">colnames(myids) &lt;- &quot;probe_id&quot;</span><br><span class="line">myid_sym &lt;- merge(myids, ids, by=&quot;probe_id&quot;)</span><br><span class="line">head(myid_sym)</span><br></pre></td></tr></table></figure>
<h1 id="task3-找某个基因在表达矩阵中的值并分组绘图"><a class="markdownIt-Anchor" href="#task3-找某个基因在表达矩阵中的值并分组绘图"></a> Task3 找某个基因在表达矩阵中的值并分组绘图</h1>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 找到R包CLL内置的数据集的表达矩阵里面的TP53基因的表达量，并且绘制在 progres.-stable分组的boxplot图</span><br><span class="line"># 提示：</span><br><span class="line"># suppressPackageStartupMessages(library(CLL))</span><br><span class="line"># data(sCLLex)</span><br><span class="line"># sCLLex</span><br><span class="line"># exprSet=exprs(sCLLex)   </span><br><span class="line"># library(hgu95av2.db)</span><br></pre></td></tr></table></figure>
<p>以下是代码部分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rm(list=ls())</span><br><span class="line">library(CLL)</span><br><span class="line">data(sCLLex)</span><br><span class="line">expr &lt;- exprs(sCLLex)</span><br><span class="line">pdata &lt;- pData(sCLLex)</span><br><span class="line">head(expr)</span><br><span class="line">library(hgu95av2.db)</span><br><span class="line">probe_sym &lt;- toTable(hgu95av2SYMBOL)</span><br><span class="line">tp53_probes &lt;- probe_sym[grep(&quot;TP53$&quot;, probe_sym$symbol),]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># probe_id symbol</span><br><span class="line"># 966    1939_at   TP53</span><br><span class="line"># 997  1974_s_at   TP53</span><br><span class="line"># 1420  31618_at   TP53</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">boxplot(expr[&apos;1939_at&apos;,]~pdata$Disease)</span><br></pre></td></tr></table></figure>
<p>ggpubr<br>
<a href="http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/" target="_blank" rel="noopener">http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">library(ggpubr)</span><br><span class="line">tp53_pub &lt;- cbind(expr[&apos;1939_at&apos;,], as.data.frame(pdata$Disease))</span><br><span class="line">colnames(tp53_pub) &lt;- c(&apos;Expression&apos;,&quot;Group&quot;)</span><br><span class="line">p &lt;- ggboxplot(tp53_pub, y=&apos;Expression&apos;, x=&apos;Group&apos;,fill = &apos;Group&apos;, </span><br><span class="line">            palette = &apos;aaas&apos; ,add = &apos;jitter&apos;)</span><br><span class="line"># &quot;npg&quot;, &quot;aaas&quot;, &quot;lancet&quot;, &quot;jco&quot;, &quot;ucscgb&quot;, &quot;uchicago&quot;, &quot;simpsons&quot; &quot;rickandmorty&quot;</span><br><span class="line">p + stat_compare_means()</span><br><span class="line">p + stat_compare_means(method = &apos;t.test&apos;)</span><br><span class="line">#the violin plot</span><br><span class="line">my_comparisons &lt;- list(c(&quot;progress.&quot;, &quot;stable&quot;))</span><br><span class="line">ggviolin(tp53_pub, y=&apos;Expression&apos;, x=&apos;Group&apos;,fill = &apos;Group&apos;, </span><br><span class="line">         palette = &apos;aaas&apos; ,add = &apos;boxplot&apos;, add.params = list(fill = &apos;white&apos;))+</span><br><span class="line">         stat_compare_means(comparisons = my_comparisons, method = &quot;t.test&quot;)+</span><br><span class="line">         stat_compare_means(label.y = 5)</span><br></pre></td></tr></table></figure>
<h1 id="task4对任意肿瘤的任意基因进行分类做图用cbioportal"><a class="markdownIt-Anchor" href="#task4对任意肿瘤的任意基因进行分类做图用cbioportal"></a> Task4:对任意肿瘤的任意基因进行分类做图（用cBioPortal）</h1>
<blockquote>
<p>cbioportal下载，即利用在线数据（下载），本地进行改观<br>
<a href="http://www.cbioportal.org/index.do" target="_blank" rel="noopener">http://www.cbioportal.org/index.do</a><br>
Select Studies 选项中输入Breast Invasive Carcinoma PanCancer 搜索并选中目标数据集<br>
Enter Genes 数据框中输入目标基因BRCA1<br>
点击Submit Query提交搜索请求<br>
结果页面中，Plots选项卡选择合适数据进行绘图，或下载数据</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">rm(list = ls())</span><br><span class="line">options(stringsAsFactors = F)</span><br><span class="line">a=read.table(&apos;e4-plot.txt&apos;,sep = &apos;\t&apos;,fill = T,header = T)</span><br><span class="line">View(a)</span><br><span class="line">colnames(a)=c(&apos;id&apos;,&apos;subtype&apos;,&apos;expression&apos;,&apos;mut&apos;)</span><br><span class="line">dat=a</span><br><span class="line">library(ggstatsplot)</span><br><span class="line">ggbetweenstats(data =dat, x = subtype,  y = expression)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggsave(&apos;plot-again-BRCA1-TCGA-BRCA-cbioportal.png&apos;)</span><br></pre></td></tr></table></figure>
<h1 id="task5某基因在某肿瘤中的生存曲线作图美化"><a class="markdownIt-Anchor" href="#task5某基因在某肿瘤中的生存曲线作图美化"></a> Task5:某基因在某肿瘤中的生存曲线作图美化</h1>
<blockquote>
<p>找到TP53基因在TCGA数据库的乳腺癌数据集的表达量分组看其是否影响生存<br>
提示使用：<a href="http://www.oncolnc.org/" target="_blank" rel="noopener">http://www.oncolnc.org/</a><br>
值得商榷的问题，low和high分组问题，若50：50分组，无差异<br>
个人理解，这里不必平分，可以30：30，也就是就挑高和低的30%，这是可以说明问题的</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">rm(list = ls())</span><br><span class="line">options(stringsAsFactors = F)</span><br><span class="line">a=read.table(&apos;BRCA_7157_50_50.csv&apos;,sep = &apos;,&apos;,fill = T,header = T)</span><br><span class="line">#View(a)</span><br><span class="line">dat=a</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(survival)</span><br><span class="line">library(survminer) </span><br><span class="line">table(dat$Status)</span><br><span class="line">dat$Status=ifelse(dat$Status==&apos;Dead&apos;,1,0)</span><br><span class="line">sfit &lt;- survfit(Surv(Days, Status)~Group, data=dat)</span><br><span class="line">sfit</span><br><span class="line">summary(sfit)</span><br><span class="line">ggsurvplot(sfit, conf.int=F, pval=TRUE)</span><br><span class="line">ggsave(&apos;survival_TP53_in_BRCA_TCGA.png&apos;)</span><br></pre></td></tr></table></figure>
<h1 id="task6geo下载表达数据并提取特定的基因做热图要去重复"><a class="markdownIt-Anchor" href="#task6geo下载表达数据并提取特定的基因做热图要去重复"></a> Task6：GEO下载表达数据并提取特定的基因做热图（要去重复）</h1>
<blockquote>
<p>下载数据集GSE17215的表达矩阵并且提取下面的基因画热图<br>
ACTR3B ANLN BAG1 BCL2 BIRC5 BLVRA CCNB1 CCNE1 CDC20 CDC6 CDCA1 CDH3<br>
CENPF CEP55 CXXC5 EGFR ERBB2 ESR1 EXO1 FGFR4 FOXA1 FOXC1 GPR160 GRB7<br>
KIF2C KNTC2 KRT14 KRT17 KRT5 MAPT MDM2 MELK MIA MKI67 MLPH MMP11 MYBL2<br>
MYC NAT1 ORC6L PGR PHGDH PTTG1 RRM2 SFRP1 SLC39A6 TMEM45B TYMS UBE2C UBE2T<br>
GSE17215数据在https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE17215<br>
可知，是U133A的芯片数据,共6个样本<br>
title为Expression data from paclitaxel and salinomycin-treated HMLER breast cancer cells</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">library(hgu133a.db)</span><br></pre></td></tr></table></figure>
<h2 id="有三种方法得到表达数据"><a class="markdownIt-Anchor" href="#有三种方法得到表达数据"></a> 有三种方法得到表达数据</h2>
<h3 id="1下载cel格式文件自己进行处理"><a class="markdownIt-Anchor" href="#1下载cel格式文件自己进行处理"></a> 1.下载.CEL格式文件，自己进行处理</h3>
<h3 id="2手动下载series-matrix-files然后读入"><a class="markdownIt-Anchor" href="#2手动下载series-matrix-files然后读入"></a> 2.手动下载series Matrix Files，然后读入</h3>
<h3 id="3利用r下载表达数据"><a class="markdownIt-Anchor" href="#3利用r下载表达数据"></a> 3.利用R下载表达数据</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">library(GEOquery)</span><br><span class="line">library(GEOquery)</span><br><span class="line">#GEO使用https://www.bioconductor.org/packages/release/bioc/vignettes/GEOquery/inst/doc/GEOquery.html</span><br><span class="line">gse17215 &lt;- getGEO(&apos;GSE17215&apos;,</span><br><span class="line">                   AnnotGPL = F,     ## 注释文件</span><br><span class="line">                   getGPL = F)       ## 平台文件</span><br><span class="line">show(gse17215)</span><br><span class="line">dat &lt;- exprs(gse17215[[1]])</span><br><span class="line">pdata_17215 &lt;- pData(gse17215[[1]])</span><br><span class="line">pdata_17215$`agent:ch1`</span><br><span class="line"></span><br><span class="line">#提取hgu133a包中的probe_id和symbol</span><br><span class="line">ids &lt;- toTable(hgu133aSYMBOL)</span><br><span class="line">dat &lt;- dat[ids$probe_id,]#合并，也可以用merge</span><br><span class="line">#这里有个问题，一共50个基因名，但是得到的是87个探针，也就是有一个gene对应几个探针的情况</span><br><span class="line">#怎么处理？ 取median或者去p最小的,也有取均值的,</span><br><span class="line">#先把median加到ids最后一列</span><br><span class="line">ids$median &lt;- apply(dat, 1, median)</span><br><span class="line">head(ids)</span><br><span class="line">ids &lt;- ids[order(ids$symbol, ids$median, decreasing = T),]</span><br><span class="line">head(ids)</span><br><span class="line">ids_dup &lt;- ids[!duplicated(ids$symbol),]</span><br><span class="line">head(ids_dup)</span><br><span class="line">dat &lt;- dat[ids_dup$probe_id,]</span><br><span class="line">dim(dat)</span><br><span class="line">#这样就得到了去重重复的探针在6个样本中的表达信息，但没有基因名</span><br><span class="line">dat &lt;- as.data.frame(dat)</span><br><span class="line">dat$probe_id &lt;- rownames(dat)</span><br><span class="line">dat_symbol &lt;- merge(dat, ids, by =&quot;probe_id&quot;)</span><br><span class="line">#载入50个基因名</span><br><span class="line">genes &lt;- &apos;ACTR3B ANLN BAG1 BCL2 BIRC5 BLVRA CCNB1 CCNE1 CDC20 CDC6 CDCA1 CDH3 CENPF CEP55 CXXC5 EGFR ERBB2 ESR1 EXO1 FGFR4 FOXA1 FOXC1 GPR160 GRB7 KIF2C KNTC2 KRT14 KRT17 KRT5 MAPT MDM2 MELK MIA MKI67 MLPH MMP11 MYBL2 MYC NAT1 ORC6L PGR PHGDH PTTG1 RRM2 SFRP1 SLC39A6 TMEM45B TYMS UBE2C UBE2T&apos;</span><br><span class="line">genes &lt;- strsplit(genes, &apos; &apos;)[[1]]</span><br><span class="line">genes &lt;- data.frame(genes)</span><br><span class="line">colnames(genes) &lt;- &apos;symbol&apos;</span><br><span class="line">genes_expr &lt;- merge(genes, dat_symbol, by =&apos;symbol&apos;)</span><br><span class="line">#至此完成了探针过滤，加基因名等操作</span><br><span class="line">#取对数</span><br><span class="line">genes_expr &lt;- log2(dat+1)</span><br><span class="line">heat_expr &lt;- genes_expr[,-c(2,9)]</span><br><span class="line">rownames(heat_expr) &lt;- heat_expr$symbol </span><br><span class="line">heat_expr &lt;- heat_expr[,-1]</span><br><span class="line">heat_expr &lt;- log2(heat_expr+1)</span><br><span class="line">pheatmap::pheatmap(heat_expr, scale = &apos;row&apos;)</span><br><span class="line">ggcorrplot::ggcorrplot(cor(heat_expr))</span><br></pre></td></tr></table></figure>
<h1 id="task7geo下载表达矩阵做样本的相关性热图需要标记样本分组信息"><a class="markdownIt-Anchor" href="#task7geo下载表达矩阵做样本的相关性热图需要标记样本分组信息"></a> Task7:GEO下载表达矩阵做样本的相关性热图，需要标记样本分组信息</h1>
<blockquote>
<p>作业7<br>
下载数据集GSE24673的表达矩阵计算样本的相关性并且绘制热图，需要标记上样本分组信息<br>
数据地址https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE24673</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">rm(list=ls())</span><br><span class="line">options(stringsAsFactors = F)   </span><br><span class="line">gse24673 &lt;- getGEO(&apos;GSE24673&apos;,</span><br><span class="line">                   AnnotGPL = F,     ## 注释文件</span><br><span class="line">                   getGPL = F)       ## 平台文件</span><br><span class="line">show(gse24673)</span><br><span class="line">dat &lt;- exprs(gse24673[[1]])</span><br><span class="line">pdata_24673 &lt;- pData(gse24673[[1]]) </span><br><span class="line">pdata_24673 &lt;- pdata_24673$source_name_ch1</span><br><span class="line">pdata_24673 &lt;- data.frame(Group = pdata_24673)</span><br><span class="line">#添加分组信息</span><br><span class="line">rownames(pdata_24673) &lt;- colnames(cor_dat)</span><br><span class="line">pheatmap::pheatmap(cor_dat, annotation_col=pdata_24673)</span><br></pre></td></tr></table></figure>
<h1 id="task8-找到芯片对应平台的注释包并进行安装"><a class="markdownIt-Anchor" href="#task8-找到芯片对应平台的注释包并进行安装"></a> Task8： 找到芯片对应平台的注释包并进行安装</h1>
<blockquote>
<p>找到 GPL6244 platform of Affymetrix Human Gene 1.0 ST Array 对应的R的bioconductor注释包，并且安装它！<br>
参考http://www.bio-info-trainee.com/1399.html</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">options()$repos</span><br><span class="line">options()$BioC_mirror </span><br><span class="line">options(BioC_mirror=&quot;https://mirrors.ustc.edu.cn/bioc/&quot;)</span><br><span class="line">options(&quot;repos&quot; = c(CRAN=&quot;https://mirrors.tuna.tsinghua.edu.cn/CRAN/&quot;))</span><br><span class="line">BiocManager::install(&quot;hugene10sttranscriptcluster.db&quot;,ask = F,update = F)</span><br><span class="line">options()$repos</span><br><span class="line">options()$BioC_mirror</span><br></pre></td></tr></table></figure>
<h1 id="task9geo下载表达矩阵所有样本中挑选所需要的探针"><a class="markdownIt-Anchor" href="#task9geo下载表达矩阵所有样本中挑选所需要的探针"></a> Task9：GEO下载表达矩阵，所有样本中挑选所需要的探针</h1>
<blockquote>
<p>下载数据集GSE42872的表达矩阵，并且分别挑选出所有样本的(平均表达量/sd/mad/)最大的探针，<br>
并且找到它们对应的基因。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">rm(list=ls())</span><br><span class="line">options(stringsAsFactors = F)   </span><br><span class="line">gse42872 &lt;- getGEO(&apos;GSE42872&apos;,</span><br><span class="line">                   AnnotGPL = F,     ## 注释文件</span><br><span class="line">                   getGPL = F)       ## 平台文件</span><br><span class="line">show(gse42872)</span><br><span class="line">dat &lt;- as.data.frame(exprs(gse42872[[1]]))</span><br><span class="line">pdata_42872 &lt;- pData(gse42872[[1]]) </span><br><span class="line">pdata_42872 &lt;- pdata_42872$source_name_ch1</span><br><span class="line">pdata_42872 &lt;- data.frame(Group = pdata_42872)</span><br><span class="line"></span><br><span class="line">max_mean &lt;- names(sort(apply(dat,1, mean), decreasing = T))[1]</span><br><span class="line">max_sd &lt;- names(sort(apply(dat,1, sd), decreasing = T))[1]</span><br><span class="line">max_mad &lt;- names(sort(apply(dat,1, mad), decreasing = T))[1]</span><br><span class="line">str(max_max)</span><br><span class="line">library(hugene10sttranscriptcluster.db)</span><br><span class="line">list(hugene10sttranscriptcluster.db)</span><br><span class="line">###find the corresponding genes for the probes</span><br><span class="line">ids &lt;- toTable(hugene10sttranscriptclusterSYMBOL)</span><br><span class="line">ids[match(max_mad, ids$probe_id),]</span><br><span class="line">#或者</span><br><span class="line">select(hugene10sttranscriptcluster.db,</span><br><span class="line">       keys = c(max_sd, max_mad, max_mean),</span><br><span class="line">       columns = c(&quot;SYMBOL&quot;),</span><br><span class="line">       keytype = &quot;PROBEID&quot;)</span><br><span class="line">##注意，max_mad探针对应着很多基因名</span><br></pre></td></tr></table></figure>
<h1 id="10-task10"><a class="markdownIt-Anchor" href="#10-task10"></a> 10 Task10</h1>
<blockquote>
<p>这部分内容参考http://www.bio-info-trainee.com/bioconductor_China/software/limma.html<br>
下载数据集GSE42872的表达矩阵，并且根据分组使用limma做差异分析，<br>
得到差异结果矩阵</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">library(GEOquery)</span><br><span class="line">rm(list=ls())</span><br><span class="line">options(stringsAsFactors = F)   </span><br><span class="line">gse42872 &lt;- getGEO(&apos;GSE42872&apos;, GSEMatrix = TRUE,</span><br><span class="line">                   AnnotGPL = F,     ## 注释文件</span><br><span class="line">                   getGPL = F)       ## 平台文件</span><br><span class="line">show(gse42872)</span><br><span class="line">dat &lt;- as.data.frame(exprs(gse42872[[1]]))</span><br><span class="line">pdata_42872 &lt;- pData(gse42872[[1]]) </span><br><span class="line">pdata_42872 &lt;- pdata_42872$title</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">group &lt;- unlist(lapply(pdata_42872, function(x)</span><br><span class="line">&#123;</span><br><span class="line">  strsplit(x,&apos; &apos;)[[1]][4]</span><br><span class="line">&#125;</span><br><span class="line">  ))</span><br><span class="line">#pdata_42872 &lt;- data.frame(Group = pdata_42872)</span><br><span class="line">library(hugene10sttranscriptcluster.db)</span><br><span class="line">ids &lt;- toTable(hugene10sttranscriptclusterSYMBOL)</span><br><span class="line">dim(ids)</span><br><span class="line">dim(dat)</span><br><span class="line"># &gt; dim(ids)</span><br><span class="line"># [1] 19827     2</span><br><span class="line"># &gt; dim(dat)</span><br><span class="line"># [1] 33297     6</span><br><span class="line">#很多探针没有注释信息，进行过滤,/可以用merge但是需要加列</span><br><span class="line">dat_filter &lt;- dat[match(ids$probe_id,rownames(dat)),]</span><br><span class="line">dim(dat_filter)</span><br><span class="line">#用%in%进行筛选</span><br><span class="line">dat_filter2 &lt;- dat[rownames(dat) %in% ids$probe_id,]</span><br><span class="line"># &gt; dim(dat_filter)</span><br><span class="line"># [1] 19827     6</span><br><span class="line">#dat_filter is the expression matrix</span><br></pre></td></tr></table></figure>
<h2 id="差异表达分析"><a class="markdownIt-Anchor" href="#差异表达分析"></a> 差异表达分析</h2>
<p>需要分组矩阵（design），比较矩阵（contrast）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">library(limma)</span><br><span class="line">##########分组矩阵design，group中的说明。1代表是。用于每张芯片的RNA样本分类</span><br><span class="line">design &lt;- model.matrix(~0+factor(group))</span><br><span class="line">colnames(design) &lt;- levels(factor(group))</span><br><span class="line">rownames(design) &lt;- colnames(dat_filter)</span><br><span class="line">design</span><br><span class="line"># Control Vemurafenib</span><br><span class="line"># GSM1052615       1           0</span><br><span class="line"># GSM1052616       1           0</span><br><span class="line"># GSM1052617       1           0</span><br><span class="line"># GSM1052618       0           1</span><br><span class="line"># GSM1052619       0           1</span><br><span class="line"># GSM1052620       0           1</span><br><span class="line">###############比较矩阵</span><br><span class="line">colnames(design) &lt;- levels(factor(group))</span><br><span class="line">rownames(design) &lt;- colnames(dat_filter)</span><br><span class="line">design</span><br><span class="line">#再做一个比较矩阵【一般是case比control】，规定实验组和对照组并定义谁比谁</span><br><span class="line">contrast.matrix&lt;-makeContrasts(paste0(unique(group),collapse = &quot;-&quot;),levels = design)</span><br><span class="line">#或者下面。注意是Vemurafenib/Control</span><br><span class="line">contrast.matrix_2 &lt;- makeContrasts(&quot;Vemurafenib-Control&quot; ,levels = design)</span><br></pre></td></tr></table></figure>
<h2 id="筛选差异基因degs"><a class="markdownIt-Anchor" href="#筛选差异基因degs"></a> 筛选差异基因DEGs</h2>
<p>###分步进行1，这步用到实验设计矩阵</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fit &lt;- lmFit(dat_filer, design)</span><br></pre></td></tr></table></figure>
<p>###分步进行2，用到比较矩阵</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit2 &lt;- contrasts.fit(fit, contrast.matrix)</span><br><span class="line">fit2 &lt;- eBayes(fit2)</span><br></pre></td></tr></table></figure>
<p>###分步进行3</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tem_output &lt;- topTable(fit2, coef = 1, n= Inf)</span><br><span class="line">mydegs &lt;- na.omit(tem_output)</span><br></pre></td></tr></table></figure>
<p>###写成函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">deg&lt;- function(dat_filter,design,contrast)&#123;</span><br><span class="line">  ##step1</span><br><span class="line">  fit &lt;- lmFit(dat_filter,design)#用到实验设计矩阵</span><br><span class="line">  ##step2</span><br><span class="line">  fit2 &lt;- contrasts.fit(fit, contrast) #用到比较矩阵</span><br><span class="line">  fit2 &lt;- eBayes(fit2)  </span><br><span class="line">  ##step3</span><br><span class="line">  mtx = topTable(fit2, coef=1, n=Inf)</span><br><span class="line">  deg_mtx = na.omit(mtx) </span><br><span class="line">  return(deg_mtx)</span><br><span class="line">&#125;</span><br><span class="line">deg_mtx &lt;- DEG(dat_filter,design,contrast) #得到全部的差异基因矩阵</span><br><span class="line">head(DEG_mtx)</span><br></pre></td></tr></table></figure>
<h2 id="下面和symbole对应"><a class="markdownIt-Anchor" href="#下面和symbole对应"></a> 下面和symbole对应</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library(hugene10sttranscriptcluster.db)</span><br><span class="line">ids &lt;- toTable(hugene10sttranscriptclusterSYMBOL)</span><br><span class="line">deg_mtx$probe_id &lt;- rownames(deg_mtx)</span><br><span class="line">deg_mtx &lt;- merge(ids,deg_mtx, by = &apos;probe_id&apos;)</span><br><span class="line">write.csv(deg_mtx, &apos;GSE42872_DEGs_limma.csv&apos;, quote = F)</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/R/">R</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/生物信息学/">生物信息学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/统计/">统计</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->



  
    <article id="post-ggstatsplot包的安装和简单使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2019/04/27/ggstatsplot包的安装和简单使用/">ggstatsplot包的安装和简单使用</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2019/04/27/ggstatsplot包的安装和简单使用/" class="article-date">
	  <time datetime="2019-04-27T05:02:31.482Z" itemprop="datePublished">四月 27, 2019</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/R/">R</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="%5Bhttps://paulvanderlaken.com/2018/08/26/ggstatsplot-creating-graphics-including-statistical-details/%5D(https://paulvanderlaken.com/2018/08/26/ggstatsplot-creating-graphics-including-statistical-details/)">ggstatsplot</a>是很优秀的统计作图包,需要3.5及以上R<br>
安装如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">devtools::install_github(</span><br><span class="line">  repo = &quot;IndrajeetPatil/ggstatsplot&quot;, # package path on GitHub</span><br><span class="line">  dependencies = TRUE,                 # installs packages which ggstatsplot depends on</span><br><span class="line">  upgrade_dependencies = TRUE          # updates any out of date dependencies</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>用某个基因在乳腺癌中突变类型和mRNA表达关系做了一个图，比较漂亮</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">getwd()</span><br><span class="line">a = read.table(&apos;plot.txt&apos;,header = TRUE, sep = &apos;\t&apos;, fill=T)</span><br><span class="line">tail(a)</span><br><span class="line">colnames(a)=c(&apos;ID&apos;,&apos;Alternations&apos;,&apos;mRNA_expression&apos;,&apos;Mutations&apos;)</span><br><span class="line">dat = a</span><br><span class="line">library(ggstatsplot)</span><br><span class="line">ggbetweenstats(data=dat, x=Alternations, y=mRNA_expression)</span><br></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/7976641-f196ac4e89be8ca5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/R/">R</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SCI绘图/">SCI绘图</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/绘图/">绘图</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->



  
    <article id="post-R检验正态分布" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2019/04/27/R检验正态分布/">R检验数据是否符合正态分布</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2019/04/27/R检验正态分布/" class="article-date">
	  <time datetime="2019-04-27T04:47:11.241Z" itemprop="datePublished">四月 27, 2019</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/R/">R</a>
 
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>正态分布又叫高斯分布，很多统计学的理论都是假设所用的数据符合正态分布。所以在研究数据时，首先要看数据是否符合正态分布。</p>
<p>首先，R中很多安装包中有自带的数据集，所以在使用某个数据前先看它是在哪个包中。具体可以参考<a href="https://blog.csdn.net/xmuecor/article/details/37512125" target="_blank" rel="noopener">R各个包里面的数据集列表</a>.<br>
这次主要用MASS包中的crabs数据</p>
<h1 id="1-直方图检验crabs对象是否正态分布"><a class="markdownIt-Anchor" href="#1-直方图检验crabs对象是否正态分布"></a> 1 直方图检验crabs对象是否正态分布</h1>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">library(lattice)</span><br><span class="line">library(MASS)</span><br><span class="line">histogram(crabs$CW)</span><br><span class="line">histogram(~CW|sex, data = crabs,col=&apos;lightblue&apos;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>解释：<br>
<code>|</code>是统计学符号，表示“基于…的条件”，这里按螃蟹的性别进行区分处理。</p>
</blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/7976641-df90b666660ce070.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h1 id="2这条-qq图进行检测"><a class="markdownIt-Anchor" href="#2这条-qq图进行检测"></a> 2这条 QQ图进行检测</h1>
<p><code>qqnorm()</code>可以绘制QQ图。通过绘制的图是否呈现一直线判断是否符合正态分布。另外还有一个<code>qqline()</code>函数，在QQ图中绘制一条直线，QQ图中的点越接近这条直线，表示数据越接近正态分布。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">qqnorm(crabs$CW, main =&quot;QQ for Crabs&quot;)</span><br><span class="line">qqline(crabs$CW)</span><br></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/7976641-6bd671b7f31bccfb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h1 id="3-shapirotest函数"><a class="markdownIt-Anchor" href="#3-shapirotest函数"></a> 3 shapiro.test()函数</h1>
<p>上述判断方法相对比较主观，<code>shapiro.test()</code>相对比较客观。只需将检验的数据当作shapiro。test()的函数即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nortest1&lt;-shapiro.test(crabs$CW)</span><br><span class="line">nortest1</span><br></pre></td></tr></table></figure>
<p>显示为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; nortest1</span><br><span class="line"></span><br><span class="line">	Shapiro-Wilk normality test</span><br><span class="line"></span><br><span class="line">data:  crabs$CW</span><br><span class="line">W = 0.99106, p-value = 0.2542</span><br></pre></td></tr></table></figure>
<p>p-value反应服从正态分布的概率，值越小越小的概率符合，通常0.05做标准，大于0.05则表示符合正态分布（此处为0.2542），故符合正态分布</p>
<p>接下来分别检验公螃蟹和母螃蟹是否符合正态分布</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">nortest2 &lt;- with(crabs, tapply(CW, sex,shapiro.test))</span><br><span class="line">nortest2</span><br><span class="line">#结果如下</span><br><span class="line">&gt; nortest2</span><br><span class="line">$F</span><br><span class="line"></span><br><span class="line">	Shapiro-Wilk normality test</span><br><span class="line"></span><br><span class="line">data:  X[[i]]</span><br><span class="line">W = 0.98823, p-value = 0.5256</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$M</span><br><span class="line"></span><br><span class="line">	Shapiro-Wilk normality test</span><br><span class="line"></span><br><span class="line">data:  X[[i]]</span><br><span class="line">W = 0.98327, p-value = 0.2368</span><br></pre></td></tr></table></figure>
<p>可见都符合正态分布。</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/R/">R</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/统计/">统计</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->



  


</section>
          <aside id="sidebar">
  
    <div style="margin: 20px 0;">
	<div id="search-form-wrap">

    <form class="search-form">
        <label style="width: 72%;">
            <span class="screen-reader-text">Search for:</span>
            <input type="search" class="search-field" style="height: 36px; width: 100%;" placeholder=" 搜索…" value name="s" title="Search for:">
        </label>
        <input type="submit" class="search-form-submit" value="搜索">
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(无标题)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">联系我们</h3>
    <div class="widget widget_athemes_social_icons">

    	<ul class="clearfix widget-social-icons">   
    	
   			<li><a href="https://github.com/hyinli" title="Github"><i class="fa fa-github" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="kkyinli" title="Google-plus"><i class="fa fa-google-plus" aria-hidden="true"></i></a></li> 

   		
   		</ul>


   		<!--
   		<ul class="clearfix widget-social-icons">   		
   		<li class="widget-si-twitter"><a href="http://twitter.com" title="Twitter"><i class="ico-twitter"></i></a></li> 
		<li class="widget-si-facebook"><a href="http://facebook.com" title="Facebook"><i class="ico-facebook"></i></a></li>
			<li class="widget-si-gplus"><a href="http://plus.google.com" title="Google+"><i class="ico-gplus"></i></a></li>
			<li class="widget-si-pinterest"><a href="http://pinterest.com" title="Pinterest"><i class="ico-pinterest"></i></a></li>
			<li class="widget-si-flickr"><a href="http://flickr.com" title="Flickr"><i class="ico-flickr"></i></a></li>
			<li class="widget-si-instagram"><a href="http://instagram.com" title="Instagram"><i class="ico-instagram"></i></a></li>
		</ul> -->

    </div>
  </div>


  
    
  <div class="widget_athemes_tabs">
    <ul id="widget-tab" class="clearfix widget-tab-nav">
      <li class="active"><a>最新文章</a></li>
    </ul>
    <div class="widget">
      <ul>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2019/05/01/oo/">生信技能树R作业答案-高级</a></h6>
              <span>五月 1, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2019/04/29/网页右上角显示github/">github图表加到网页角落</a></h6>
              <span>四月 29, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2019/04/29/同一个github账户绑定两个域名/">同一个github账户绑定两个域名</a></h6>
              <span>四月 29, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2019/04/28/github两个账户不能进行push的解决办法/">github两个账户不能进行push的解决办法</a></h6>
              <span>四月 28, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2019/04/28/github+hexo+个人域名建立个人网站/">github+hexo+个人域名建立个人网站</a></h6>
              <span>四月 28, 2019</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2019/04/27/生信技能树R作业中/">生信技能树R作业答案-中</a></h6>
              <span>四月 27, 2019</span>
            </div>

          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/R/">R</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/github/">github</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a><span class="category-list-count">3</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/R/">R</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SCI绘图/">SCI绘图</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo-github，域名，个人网站/">hexo github，域名，个人网站</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/个人域名/">个人域名</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生物信息学/">生物信息学</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/绘图/">绘图</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/统计/">统计</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/R/" style="font-size: 20px;">R</a> <a href="/tags/SCI绘图/" style="font-size: 10px;">SCI绘图</a> <a href="/tags/github/" style="font-size: 16.67px;">github</a> <a href="/tags/hexo/" style="font-size: 13.33px;">hexo</a> <a href="/tags/hexo-github，域名，个人网站/" style="font-size: 10px;">hexo github，域名，个人网站</a> <a href="/tags/个人域名/" style="font-size: 10px;">个人域名</a> <a href="/tags/生物信息学/" style="font-size: 13.33px;">生物信息学</a> <a href="/tags/绘图/" style="font-size: 10px;">绘图</a> <a href="/tags/统计/" style="font-size: 16.67px;">统计</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>

    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a><span class="archive-list-count">7</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/links" class="mobile-nav-link">links</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2019 K1 biogithub All Rights Reserved.
        
            <span id="busuanzi_container_site_uv">
              本站访客数<span id="busuanzi_value_site_uv"></span>人次  
              本站总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
          
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hipaper" target="_blank">hipaper</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
